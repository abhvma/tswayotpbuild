import{a as O,b as y,c as ue}from"./chunk-ERF365SL.js";import{a as he}from"./chunk-EA5UX5TO.js";import"./chunk-OBO5MK2I.js";import{a as be,b as ve,c as Te}from"./chunk-B7RSQGP4.js";import{b as Ce}from"./chunk-5LLL7KMF.js";import{c as ge}from"./chunk-4HWPX7HP.js";import{b as A}from"./chunk-COTRNXSH.js";import{a as fe}from"./chunk-HVPVQXOI.js";import{$a as X,A as b,Aa as M,Ab as pe,B as v,Ba as j,Bb as me,Cb as le,D as z,Da as U,Db as ce,E as T,Gb as se,Hb as de,M as G,N as a,Na as F,Oa as J,Pa as W,R as x,U as h,V as $,X as S,Y as q,Z as d,aa as m,bb as I,db as Y,ea as n,eb as Z,fa as r,ga as s,ha as H,ia as K,ja as k,ka as u,la as f,mb as ee,sa as Q,t as B,ta as p,tb as te,u as L,ua as l,ub as ie,vb as V,w as R,wb as oe,xb as re,yb as ne,zb as ae}from"./chunk-4TWJ36SW.js";import"./chunk-FK6H3RFT.js";import"./chunk-ENRHZQ2S.js";var C=class i extends ee{constructor(t){super(t,ue)}getName(){return"otpchk"}static \u0275fac=function(e){return new(e||i)(R(te))};static \u0275prov=B({token:i,factory:i.\u0275fac})};var w=class i{transform(t){return O[t]||"Unknown"}static \u0275fac=function(e){return new(e||i)};static \u0275pipe=S({name:"otpTraceType",type:i,pure:!0,standalone:!1})};var D=class i{transform(t){let e={1:"success",0:"danger"},o=y[t];return`<span class="badge bg-${e[t]||"secondary"}">${o}</span>`}static \u0275fac=function(e){return new(e||i)};static \u0275pipe=S({name:"otpStatusBadge",type:i,pure:!0,standalone:!1})};function Fe(i,t){if(i&1&&(n(0,"th",3),p(1),r()),i&2){let e=t.$implicit;m("width",e.width),a(),l(e.label)}}function Ie(i,t){if(i&1&&(n(0,"tr")(1,"td"),p(2),M(3,"otpTraceType"),r(),n(4,"td"),p(5),r(),n(6,"td"),p(7),r(),n(8,"td"),p(9),r(),n(10,"td"),s(11,"span",4),M(12,"otpStatusBadge"),r(),n(13,"td"),p(14),r(),n(15,"td"),p(16),r(),n(17,"td"),p(18),r(),n(19,"td"),p(20),r()()),i&2){let e=t.$implicit;a(2),l(j(3,9,e.traceType)),a(3),l(e.otpNumber),a(2),l(e.otpNumberPrevious),a(2),l(e.otpNumberNext),a(2),m("innerHTML",j(12,11,e.status),G),a(3),l(e.devDate),a(2),l(e.devTime),a(2),l(e.sysTime),a(2),l(e.traceDate.date())}}var E=class i{models=[];editClick=new T;deleteClick=new T;columns=[{label:"Trace Type",width:"6%"},{label:"OTP Number",width:"10%"},{label:"Previous OTP",width:"10%"},{label:"Next OTP",width:"10%"},{label:"Status",width:"6%"},{label:"Dev Date",width:"8%"},{label:"Dev Time",width:"6%"},{label:"System Time",width:"6%"},{label:"Trace Date",width:"10%"}];static \u0275fac=function(e){return new(e||i)};static \u0275cmp=h({type:i,selectors:[["app-otpcheck-table"]],inputs:{models:"models"},outputs:{editClick:"editClick",deleteClick:"deleteClick"},standalone:!1,decls:6,vars:2,consts:[[1,"tsway-datatable","striped"],[3,"width",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"width"],[3,"innerHTML"]],template:function(e,o){e&1&&(n(0,"table",0)(1,"thead")(2,"tr"),d(3,Fe,2,2,"th",1),r()(),n(4,"tbody"),d(5,Ie,21,13,"tr",2),r()()),e&2&&(a(3),m("ngForOf",o.columns),a(2),m("ngForOf",o.models))},dependencies:[F,w,D],encapsulation:2})};function De(i,t){if(i&1&&(n(0,"option",17),p(1),r()),i&2){let e=t.$implicit;m("value",e.key),a(),l(e.value)}}function Ee(i,t){if(i&1&&(n(0,"option",17),p(1),r()),i&2){let e=t.$implicit;m("value",e.key),a(),l(e.value)}}var N=class i{constructor(t){this.fb=t;this.filterForm=this.fb.group({traceDateFrom:["",V.required],traceDateTo:["",V.required],traceType:[""],customerId:[""],bankCode:[""],status:[""]})}filterChange=new T;filterForm;subscriptions=[];EKeyStatus=y;ETraceType=O;statusOptions=Object.entries(y).filter(([t,e])=>typeof e=="number").map(([t,e])=>({key:e,value:t}));traceTypeOptions=Object.entries(O).filter(([t,e])=>typeof e=="number").map(([t,e])=>({key:e,value:t}));emitFilter(){this.filterChange.emit(this.filterForm.value)}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}static \u0275fac=function(e){return new(e||i)(x(se))};static \u0275cmp=h({type:i,selectors:[["app-otpcheck-filterbar"]],outputs:{filterChange:"filterChange"},standalone:!1,decls:32,vars:4,consts:[[1,"filterbar","mb-3"],[1,"row","g-3","align-items-end","w-100",3,"formGroup"],[1,"col"],["for","customerId",1,"form-label","small","mb-1"],["type","text","id","customerId","formControlName","customerId",1,"form-control"],["for","traceType",1,"form-label","small","mb-1"],["id","traceType","formControlName","traceType",1,"form-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","status",1,"form-label","small","mb-1"],["id","status","formControlName","status",1,"form-select"],["for","traceDateFrom",1,"form-label","small","mb-1"],["type","date","id","traceDateFrom","formControlName","traceDateFrom",1,"form-control"],["for","traceDateTo",1,"form-label","small","mb-1"],["type","date","id","traceDateTo","formControlName","traceDateTo",1,"form-control"],["type","button",1,"btn","btn-primary","w-100",3,"click","disabled"],[1,"bi","bi-search"],[3,"value"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"form",1)(2,"div",2)(3,"label",3),p(4,"Customer ID"),r(),s(5,"input",4),r(),n(6,"div",2)(7,"label",5),p(8,"Trace Type"),r(),n(9,"select",6)(10,"option",7),p(11,"All"),r(),d(12,De,2,2,"option",8),r()(),n(13,"div",2)(14,"label",9),p(15,"Status"),r(),n(16,"select",10)(17,"option",7),p(18,"All"),r(),d(19,Ee,2,2,"option",8),r()(),n(20,"div",2)(21,"label",11),p(22,"Trace From*"),r(),s(23,"input",12),r(),n(24,"div",2)(25,"label",13),p(26,"Trace To*"),r(),s(27,"input",14),r(),n(28,"div",2)(29,"button",15),u("click",function(){return o.emitFilter()}),s(30,"i",16),p(31," Search "),r()()()()),e&2&&(a(),m("formGroup",o.filterForm),a(11),m("ngForOf",o.traceTypeOptions),a(7),m("ngForOf",o.statusOptions),a(10),m("disabled",o.filterForm.invalid))},dependencies:[F,ne,le,ce,ie,me,oe,re,ae,pe],encapsulation:2})};function Pe(i,t){if(i&1){let e=k();n(0,"div",8)(1,"a",9),u("click",function(){b(e);let c=f();return v(c.downloadTable())}),s(2,"i",10),p(3," Download PDF "),r()()}}function Me(i,t){if(i&1){let e=k();n(0,"div",11)(1,"app-paginator",12),u("pageChange",function(c){b(e);let _=f();return v(_.fetchOtpLogs(c))}),r()()}if(i&2){let e=f();a(),m("pageSize",e.paginationOption.pageSize)("total",e.models.length)("startPage",1)("totalNotKnown",!0)}}function je(i,t){if(i&1&&(H(0),s(1,"app-otpcheck-table",13),K()),i&2){let e=f();a(),m("models",e.models)}}function Ve(i,t){if(i&1){let e=k();n(0,"div",11)(1,"app-paginator",12),u("pageChange",function(c){b(e);let _=f();return v(_.fetchOtpLogs(c))}),r()()}if(i&2){let e=f();a(),m("pageSize",e.paginationOption.pageSize)("total",e.models.length)("startPage",1)("totalNotKnown",!0)}}function Ae(i,t){i&1&&(n(0,"div")(1,"p",3),p(2,"Search for OTP logs"),r()())}function Be(i,t){i&1&&(n(0,"div")(1,"p",3),p(2,"No OTP log found for the given conditions."),r()())}function Le(i,t){if(i&1&&(n(0,"div",14)(1,"div"),s(2,"i",15),d(3,Ae,3,0,"div",16)(4,Be,3,0,"div",16),r()()),i&2){let e=f();a(3),m("ngIf",!e.hasSearched),a(),m("ngIf",e.hasSearched)}}var P=class i extends Ce{hasSearched=!1;constructor(t){super(t),this.modelService=t.get(C)}getFilterParams(){let t=[];return this.modelFilters.customerId&&t.push({customerId:I(this.modelFilters.customerId)}),this.modelFilters.traceDateTo&&t.push({traceDate:Z(new A(this.modelFilters.traceDateTo).date())}),this.modelFilters.traceDateFrom&&t.push({traceDate:Y(new A(this.modelFilters.traceDateFrom).date())}),this.modelFilters.traceType&&t.push({traceType:I(this.modelFilters.traceType)}),this.modelFilters.status&&t.push({status:I(this.modelFilters.status)}),t}loadModels(){return this.fetchOtpLogs(this.paginationOption.currentPage)}openDialog(t){throw new Error("Method not implemented.")}applyFilters(){this.loadModels().then()}fetchOtpLogs(t=0){let e=new fe;return e.show(),this.paginationOption.currentPage=t,this.modelService.paginate(this.getFilterParams(),{traceDate:"DESC"},t).then(o=>(this.hasSearched=!0,this.models=o,o)).finally(()=>{e.hide()})}downloadTable(){let t=new be;t.setFontSize(12);let e=this.models.map(o=>({customerId:o.customer.customerId,customerName:o.customer.customerName,traceDate:o.traceDate.toLocaleString(),traceNumber:o.traceNumber,traceType:o.traceType,bankCode:o.bankCode,otpNumber:o.otpNumber,status:o.status,prevOtp:o.otpNumberPrevious,nextOtp:o.otpNumberNext,devDate:o.devDate.date(),devTime:o.devTime.time(),sysTime:o.sysTime.time()}));ve(t,{head:[["Customer Id","Customer Name","Trace Type","OTP Number","Prev OTP","Next OTP","Status","Dev Date","Dev Time","System Time","Trace Date"]],body:e.map(o=>[o.customerId,o.customerName,o.traceType,o.otpNumber,o.nextOtp,o.status,o.devDate,o.devTime,o.sysTime,o.traceDate])}),t.save(`otpcheck-log${new Date().toDateString()}.pdf`)}static \u0275fac=function(e){return new(e||i)(x(z))};static \u0275cmp=h({type:i,selectors:[["app-otpcheck"]],standalone:!1,features:[q],decls:11,vars:5,consts:[["noData",""],[1,"container-fluid","py-4","d-flex","flex-column","vh-100"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"mb-0"],[3,"filterChange"],["class","d-flex justify-content-end mb-2",4,"ngIf"],["class","mb-4",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-end","mb-2"],["role","button",1,"btn-link","text-muted","small","text-decoration-none",3,"click"],[1,"bi","bi-file-earmark-pdf","me-1"],[1,"mb-4"],[3,"pageChange","pageSize","total","startPage","totalNotKnown"],[3,"models"],[1,"d-flex","justify-content-center","align-items-center","h-100","text-muted","text-center","px-4"],[1,"bi","bi-search","display-6","d-block","mb-2"],[4,"ngIf"]],template:function(e,o){if(e&1){let c=k();n(0,"div",1)(1,"div",2)(2,"h2",3),p(3,"OTP Check Logs"),r()(),n(4,"app-otpcheck-filterbar",4),u("filterChange",function(_e){return b(c),v(o.onFilterChange(_e))}),r(),d(5,Pe,4,0,"div",5)(6,Me,2,4,"div",6)(7,je,2,1,"ng-container",7)(8,Ve,2,4,"div",6)(9,Le,5,2,"ng-template",null,0,U),r()}if(e&2){let c=Q(10);a(5),m("ngIf",o.models.length>0),a(),m("ngIf",o.hasSearched),a(),m("ngIf",o.models.length>0)("ngIfElse",c),a(),m("ngIf",o.hasSearched)}},dependencies:[J,Te,E,N],encapsulation:2})};var Re=[{path:"",component:P}],ye=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=$({type:i});static \u0275inj=L({providers:[C,he],imports:[ge,W,X.forChild(Re),de]})};export{ye as OtpCheckModule};
