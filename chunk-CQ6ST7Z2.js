import{b as se}from"./chunk-AATRHK66.js";import{c as ne}from"./chunk-FKFP3K5F.js";import{b as y}from"./chunk-ZRACD77Y.js";import{b as pe}from"./chunk-BHCFKVDP.js";import{b as me,c as f,d as de}from"./chunk-7B427YM3.js";import{a as le,c as ue}from"./chunk-UJRL6OBK.js";import{a as ae}from"./chunk-HVPVQXOI.js";import{a as w,c as D}from"./chunk-4C77SNZT.js";import{A as B,Ab as F,B as K,Bb as N,C as j,Cb as E,Db as T,E as Q,Ea as ee,Eb as _,F as g,Fb as I,Gb as q,Hb as x,Kb as O,Lb as oe,O as a,Pa as te,Qa as re,S as p,V as b,W as z,Z as L,_ as $,ab as ie,ba as o,cb as A,eb as G,fa as i,fb as P,ga as t,ha as s,ia as H,ja as J,ka as W,la as c,ma as X,ta as Y,ua as n,v as R,xa as Z,xb as C,yb as u,zb as h}from"./chunk-RHKCHBCJ.js";import{h as v}from"./chunk-ENRHZQ2S.js";var V=class l{constructor(m,r,e){this.fb=m;this.toast=r;this.serialKeyService=e;this.userForm=this.fb.group({otptype:[2,u.required],count:[1,[u.required,u.min(1),u.max(1e4)]],branch_cd:[void 0,u.required],bank_cd:[void 0,u.required],command:[3]})}user;setting;save=new g;cancel=new g;modalTitle="Generate Keys";userForm;eOtpType=D;dialogRef;userNotUnique=!1;ngOnChanges(){this.user&&this.userForm.get("branch_cd").setValue(this.user.branchName),this.setting&&this.userForm.get("bank_cd").setValue(this.setting.bankCode)}onSave(){return v(this,null,function*(){let m=new ae;try{m.show(),yield this.serialKeyService.generateKey(this.userForm.value),this.dialogRef.close(void 0),this.toast.success(`${this.userForm.value.count} key generated successfully.`)}catch{}finally{m.hide()}})}onCancel(){this.dialogRef.close(void 0),this.cancel.emit()}get formControls(){return this.userForm.controls}static \u0275fac=function(r){return new(r||l)(p(O),p(le),p(f))};static \u0275cmp=b({type:l,selectors:[["app-serial-number-create-modal"]],inputs:{user:"user",setting:"setting"},outputs:{save:"save",cancel:"cancel"},standalone:!1,features:[Z([y,f]),B],decls:24,vars:4,consts:[[1,"modal-content",3,"formGroup"],[1,"tsway-modal-header"],[1,"tsway-modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"tsway-modal-body"],[1,"row"],[1,"col-md"],["for","otptype",1,"form-label","small","mb-1"],["id","otptype","formControlName","otptype",1,"form-control"],[3,"ngValue"],["for","count",1,"form-label","small","mb-1"],["type","number","formControlName","count","id","count",1,"form-control"],[1,"tsway-modal-footer","d-flex","flex-row-reverse","justify-content-start"],[1,"btn","btn-primary",3,"click","disabled"],[1,"btn","btn-danger","me-2","text-white",3,"click"]],template:function(r,e){r&1&&(i(0,"form",0)(1,"div",1)(2,"h5",2),n(3,"Generate Key"),t(),i(4,"button",3),c("click",function(){return e.onCancel()}),t()(),i(5,"div",4)(6,"div",5)(7,"section",6)(8,"label",7),n(9,"Type"),t(),i(10,"select",8)(11,"option",9),n(12,"Card"),t(),i(13,"option",9),n(14,"Token"),t()()(),i(15,"section",6)(16,"label",10),n(17,"Number of Key to generate?"),t(),s(18,"input",11),t()()(),i(19,"div",12)(20,"button",13),c("click",function(){return e.onSave()}),n(21," Save "),t(),i(22,"button",14),c("click",function(){return e.onCancel()}),n(23," Cancel "),t()()()),r&2&&(o("formGroup",e.userForm),a(11),o("ngValue",e.eOtpType.Card),a(2),o("ngValue",e.eOtpType.Token),a(7),o("disabled",e.userForm.invalid))},dependencies:[N,q,x,C,E,I,h,F,T,_],styles:["[_nghost-%COMP%]{font-size:.875rem!important}"]})};var k=class l{constructor(m){this.fb=m;let r=new w().date();this.filterForm=this.fb.group({type:[null],dateFrom:[r,u.required],dateTo:[r,u.required],status:[void 0],sequenceStart:[],sequenceEnd:[]}),this.dateFrom=this.filterForm.get("dateFrom"),this.dateTo=this.filterForm.get("dateTo")}filterChange=new g;filterForm;eSerialType=D;eStatusType=me;dateFrom;dateTo;onSubmit(){this.filterChange.emit({type:this.filterForm.get("type").value,dateTo:this.dateFrom.value?new w(this.dateFrom.value):void 0,dateFrom:this.dateTo.value?new w(this.dateTo.value):void 0,status:this.filterForm.get("status").value,sequenceStart:this.filterForm.get("sequenceStart").value,sequenceEnd:this.filterForm.get("sequenceEnd").value})}ngOnDestroy(){}static \u0275fac=function(r){return new(r||l)(p(O))};static \u0275cmp=b({type:l,selectors:[["app-serial-key-filterbar"]],outputs:{filterChange:"filterChange"},standalone:!1,decls:46,vars:10,consts:[[1,"filterbar","mb-3"],[1,"row","g-3","align-items-end",3,"formGroup"],[1,"col-md"],["for","type",1,"form-label","small","mb-1"],["id","type","formControlName","type",1,"form-control"],[3,"ngValue"],["for","sequenceStart",1,"form-label","small","mb-1"],["type","number","id","sequenceStart","formControlName","sequenceStart",1,"form-control"],["for","sequenceEnd",1,"form-label","small","mb-1"],["type","number","id","sequenceEnd","formControlName","sequenceEnd",1,"form-control"],["for","dateFrom",1,"form-label","small","mb-1"],["type","date","id","dateFrom","formControlName","dateFrom",1,"form-control"],["for","dateTo",1,"form-label","small","mb-1"],["type","date","id","dateTo","formControlName","dateTo",1,"form-control"],["for","status",1,"form-label","small","mb-1"],["id","status","formControlName","status",1,"form-control"],[1,"col-auto"],[1,"btn","btn-primary","w-100","d-flex","align-items-center","justify-content-center","gap-2",3,"click","disabled"],[1,"bi","bi-search"]],template:function(r,e){r&1&&(i(0,"div",0)(1,"form",1)(2,"div",2)(3,"label",3),n(4,"Type"),t(),i(5,"select",4)(6,"option",5),n(7,"All"),t(),i(8,"option",5),n(9,"Card"),t(),i(10,"option",5),n(11,"Token"),t()()(),i(12,"div",2)(13,"label",6),n(14,"Sequence Start"),t(),s(15,"input",7),t(),i(16,"div",2)(17,"label",8),n(18,"Sequence End"),t(),s(19,"input",9),t(),i(20,"div",2)(21,"label",10),n(22,"From*"),t(),s(23,"input",11),t(),i(24,"div",2)(25,"label",12),n(26,"To*"),t(),s(27,"input",13),t(),i(28,"div",2)(29,"label",14),n(30,"Status"),t(),i(31,"select",15)(32,"option",5),n(33,"All"),t(),i(34,"option",5),n(35,"Created"),t(),i(36,"option",5),n(37,"Delivered"),t(),i(38,"option",5),n(39,"Assigned"),t(),i(40,"option",5),n(41,"Inactive"),t()()(),i(42,"div",16)(43,"button",17),c("click",function(){return e.onSubmit()}),s(44,"i",18),n(45," Search "),t()()()()),r&2&&(a(),o("formGroup",e.filterForm),a(5),o("ngValue",null),a(2),o("ngValue",e.eSerialType.Card),a(2),o("ngValue",e.eSerialType.Token),a(22),o("ngValue",null),a(2),o("ngValue",e.eStatusType.Created),a(2),o("ngValue",e.eStatusType.Delivered),a(2),o("ngValue",e.eStatusType.Assigned),a(2),o("ngValue",e.eStatusType.Inactive),a(3),o("disabled",e.filterForm.invalid))},dependencies:[N,q,x,C,E,I,h,F,T,_],encapsulation:2})};function Ce(l,m){if(l&1&&(H(0),s(1,"app-serial-number-table",9),J()),l&2){let r=X();a(),o("models",r.models)}}function he(l,m){l&1&&(i(0,"div",10)(1,"div"),s(2,"i",11),i(3,"p",4),n(4,"Key records not found."),t()()())}var M=class l extends pe{constructor(r,e,d,S){super(S);this.authService=e;this.settingService=d;this.modelService=r}setting;user;getFilterParams(){let r=[],e=this.modelFilters;return e.type&&r.push({otpType:A(e.type)}),(e.status!==void 0||e.status!==null)&&r.push({status:A(e.status)}),e.dateFrom&&r.push({createdDate:G(e.dateFrom.date())}),e.dateTo&&r.push({createdDate:P(e.dateTo.date())}),e.sequenceStart&&r.push({sequenceNumber:G(e.sequenceStart)}),e.sequenceEnd&&r.push({sequenceNumber:P(e.sequenceEnd)}),r}ngOnInit(){this.settingService.find().then(r=>{this.setting=r}),this.user=this.authService.authUser()}applyFilters(){this.loadModels().then()}openDialog(r){return v(this,null,function*(){(yield this.dialog.open(V,{user:this.user,setting:this.setting},{width:"35%"})).closed.subscribe(d=>{})})}static \u0275fac=function(e){return new(e||l)(p(f),p(ne),p(y),p(Q))};static \u0275cmp=b({type:l,selectors:[["app-serial-number"]],standalone:!1,features:[L],decls:12,vars:2,consts:[["button",""],["noData",""],[1,"container-fluid","py-4","d-flex","flex-column","vh-100"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"mb-0"],[1,"btn","btn-danger","text-white",3,"click"],[1,"bi","bi-plus-lg","me-1"],[3,"filterChange"],[4,"ngIf","ngIfElse"],[3,"models"],[1,"d-flex","justify-content-center","align-items-center","h-100","text-muted","text-center","px-4"],[1,"bi","bi-search","display-6","d-block","mb-2"]],template:function(e,d){if(e&1){let S=W();i(0,"div",2)(1,"div",3)(2,"h2",4),n(3,"OTP Keys"),t(),i(4,"button",5,0),c("click",function(){return K(S),j(d.addModel())}),s(6,"i",6),n(7,"Create Key "),t()(),i(8,"app-serial-key-filterbar",7),c("filterChange",function(be){return K(S),j(d.onFilterChange(be))}),t(),$(9,Ce,2,1,"ng-container",8)(10,he,5,0,"ng-template",null,1,ee),t()}if(e&2){let S=Y(11);a(9),o("ngIf",d.models.length>0)("ngIfElse",S)}},dependencies:[se,te,k],encapsulation:2})};var Fe=[{path:"",component:M}],fe=class l{static \u0275fac=function(r){return new(r||l)};static \u0275mod=z({type:l});static \u0275inj=R({providers:[y,f],imports:[de,re,ie.forChild(Fe),oe,ue]})};export{fe as SerialNumberModule};
