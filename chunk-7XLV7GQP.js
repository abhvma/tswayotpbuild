import{a as k,b as v,c as te}from"./chunk-MVWK5YE4.js";import{a as F}from"./chunk-2SQI33W7.js";import"./chunk-DICJOYZV.js";import"./chunk-KH7BRNI5.js";import{a as he,b as Ce}from"./chunk-TFFLQK24.js";import{b as fe}from"./chunk-IDTBANS2.js";import{a as Z}from"./chunk-5ZKVGYZB.js";import{c as ue}from"./chunk-U6LKOZVF.js";import{b as j}from"./chunk-44S3GGHA.js";import"./chunk-HVPVQXOI.js";import{d as X,e as Y}from"./chunk-MXDAFLWT.js";import{A as D,Aa as M,B as w,Ca as K,D as G,E as C,M as $,Ma as O,N as a,Na as U,Oa as J,R as g,U as f,V as H,X as y,Y as q,Z as s,_a as W,aa as m,bb as ee,cb as ie,db as B,ea as n,eb as oe,fa as r,fb as re,ga as l,gb as ne,ha as L,hb as ae,ia as Q,ib as pe,ja as N,jb as me,ka as b,kb as le,la as T,lb as ce,ob as se,pb as de,sa as z,t as V,ta as p,u as A,ua as c,w as R,za as P}from"./chunk-VL4RAH5U.js";import"./chunk-FK6H3RFT.js";import"./chunk-ENRHZQ2S.js";var u=class i extends Z{constructor(t){super(t,te)}getName(){return"otpchk"}static \u0275fac=function(e){return new(e||i)(R(ee))};static \u0275prov=V({token:i,factory:i.\u0275fac})};var S=class i{transform(t){return k[t]||"Unknown"}static \u0275fac=function(e){return new(e||i)};static \u0275pipe=y({name:"otpTraceType",type:i,pure:!0,standalone:!1})};var I=class i{transform(t){let e={1:"success",0:"danger"},o=v[t];return`<span class="badge bg-${e[t]||"secondary"}">${o}</span>`}static \u0275fac=function(e){return new(e||i)};static \u0275pipe=y({name:"otpStatusBadge",type:i,pure:!0,standalone:!1})};function Oe(i,t){if(i&1&&(n(0,"th",3),p(1),r()),i&2){let e=t.$implicit;m("width",e.width),a(),c(e.label)}}function Fe(i,t){if(i&1&&(n(0,"tr")(1,"td"),p(2),r(),n(3,"td"),p(4),P(5,"otpTraceType"),r(),n(6,"td"),p(7),r(),n(8,"td"),p(9),r(),n(10,"td"),p(11),r(),n(12,"td"),l(13,"span",4),P(14,"otpStatusBadge"),r(),n(15,"td"),p(16),r()()),i&2){let e=t.$implicit;a(2),c(e.traceNumber),a(2),c(M(5,7,e.traceType)),a(3),c(e.customerId),a(2),c(e.customer==null?null:e.customer.customerName),a(2),c(e.otpNumber),a(2),m("innerHTML",M(14,9,e.status),$),a(3),c(e.traceDate)}}var x=class i{models=[];editClick=new C;deleteClick=new C;columns=[{label:"Trace Number",width:"12%"},{label:"Trace Type",width:"10%"},{label:"Customer ID",width:"10%"},{label:"Customer Name",width:"14%"},{label:"OPT Number",width:"12%"},{label:"Status",width:"8%"},{label:"Trace Date",width:"10%"}];static \u0275fac=function(e){return new(e||i)};static \u0275cmp=f({type:i,selectors:[["app-otpcheck-table"]],inputs:{models:"models"},outputs:{editClick:"editClick",deleteClick:"deleteClick"},standalone:!1,decls:6,vars:2,consts:[[1,"tsway-datatable","striped"],[3,"width",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"width"],[3,"innerHTML"]],template:function(e,o){e&1&&(n(0,"table",0)(1,"thead")(2,"tr"),s(3,Oe,2,2,"th",1),r()(),n(4,"tbody"),s(5,Fe,17,11,"tr",2),r()()),e&2&&(a(3),m("ngForOf",o.columns),a(2),m("ngForOf",o.models))},dependencies:[O,S,I],encapsulation:2})};function Ie(i,t){if(i&1&&(n(0,"option",17),p(1),r()),i&2){let e=t.$implicit;m("value",e.key),a(),c(e.value)}}function xe(i,t){if(i&1&&(n(0,"option",17),p(1),r()),i&2){let e=t.$implicit;m("value",e.key),a(),c(e.value)}}var _=class i{constructor(t){this.fb=t;this.filterForm=this.fb.group({traceDateFrom:["",B.required],traceDateTo:["",B.required],traceType:[""],customerId:[""],bankCode:[""],status:[""]})}filterChange=new C;filterForm;subscriptions=[];EKeyStatus=v;ETraceType=k;statusOptions=Object.entries(v).filter(([t,e])=>typeof e=="number").map(([t,e])=>({key:e,value:t}));traceTypeOptions=Object.entries(k).filter(([t,e])=>typeof e=="number").map(([t,e])=>({key:e,value:t}));emitFilter(){this.filterChange.emit(this.filterForm.value)}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}static \u0275fac=function(e){return new(e||i)(g(se))};static \u0275cmp=f({type:i,selectors:[["app-otpcheck-filterbar"]],outputs:{filterChange:"filterChange"},standalone:!1,decls:32,vars:4,consts:[[1,"filterbar","mb-3"],[1,"row","g-3","align-items-end","w-100",3,"formGroup"],[1,"col"],["for","customerId",1,"form-label","small","mb-1"],["type","text","id","customerId","formControlName","customerId",1,"form-control"],["for","traceType",1,"form-label","small","mb-1"],["id","traceType","formControlName","traceType",1,"form-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","status",1,"form-label","small","mb-1"],["id","status","formControlName","status",1,"form-select"],["for","traceDateFrom",1,"form-label","small","mb-1"],["type","date","id","traceDateFrom","formControlName","traceDateFrom",1,"form-control"],["for","traceDateTo",1,"form-label","small","mb-1"],["type","date","id","traceDateTo","formControlName","traceDateTo",1,"form-control"],["type","button",1,"btn","btn-primary","w-100",3,"click","disabled"],[1,"bi","bi-search"],[3,"value"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"form",1)(2,"div",2)(3,"label",3),p(4,"Customer ID"),r(),l(5,"input",4),r(),n(6,"div",2)(7,"label",5),p(8,"Trace Type"),r(),n(9,"select",6)(10,"option",7),p(11,"All"),r(),s(12,Ie,2,2,"option",8),r()(),n(13,"div",2)(14,"label",9),p(15,"Status"),r(),n(16,"select",10)(17,"option",7),p(18,"All"),r(),s(19,xe,2,2,"option",8),r()(),n(20,"div",2)(21,"label",11),p(22,"Trace From*"),r(),l(23,"input",12),r(),n(24,"div",2)(25,"label",13),p(26,"Trace To*"),r(),l(27,"input",14),r(),n(28,"div",2)(29,"button",15),b("click",function(){return o.emitFilter()}),l(30,"i",16),p(31," Search "),r()()()()),e&2&&(a(),m("formGroup",o.filterForm),a(11),m("ngForOf",o.traceTypeOptions),a(7),m("ngForOf",o.statusOptions),a(10),m("disabled",o.filterForm.invalid))},dependencies:[O,ne,le,ce,ie,me,oe,re,ae,pe],encapsulation:2})};function Ee(i,t){if(i&1){let e=N();n(0,"div",7)(1,"a",8),b("click",function(){D(e);let d=T();return w(d.downloadTable())}),l(2,"i",9),p(3," Download PDF "),r()()}}function De(i,t){if(i&1&&(L(0),l(1,"app-otpcheck-table",10),Q()),i&2){let e=T();a(),m("models",e.models)}}function we(i,t){i&1&&(n(0,"div")(1,"p",3),p(2,"Search for OTP logs"),r()())}function Ne(i,t){i&1&&(n(0,"div")(1,"p",3),p(2,"No OTP log found for the given conditions."),r()())}function Pe(i,t){if(i&1&&(n(0,"div",11)(1,"div"),l(2,"i",12),s(3,we,3,0,"div",13)(4,Ne,3,0,"div",13),r()()),i&2){let e=T();a(3),m("ngIf",!e.hasSearched),a(),m("ngIf",e.hasSearched)}}var E=class i extends fe{hasSearched=!1;customerService;constructor(t){super(t),this.modelService=t.get(u),this.customerService=t.get(F)}loadCustomers(){this.models.length!==0&&this.customerService.get().then(t=>{let e={};t.forEach(o=>{e[o.customerId]=o}),this.models.forEach(o=>{o.customer=e[o.customerId]})})}getFilterParams(){let t=[];return this.modelFilters.customerId&&t.push({customerId:this.modelFilters.customerId}),this.modelFilters.traceDateTo&&t.push({traceDate:Y(new j(this.modelFilters.traceDateTo))}),this.modelFilters.traceDateFrom&&t.push({traceDate:X(new j(this.modelFilters.traceDateFrom))}),this.modelFilters.traceType&&t.push({traceType:this.modelFilters.traceType}),this.modelFilters.status&&t.push({status:this.modelFilters.status}),t}loadModels(){return super.loadModels().then(()=>(this.hasSearched=!0,this.loadCustomers(),this.models))}openDialog(t){throw new Error("Method not implemented.")}applyFilters(){this.loadModels().then()}downloadTable(){let t=new he;t.setFontSize(12);let e=this.models.map(o=>({traceDate:o.traceDate.toLocaleString(),traceNumber:o.traceNumber,customerId:o.customerId,traceType:o.traceType,bankCode:o.bankCode,otpNumber:o.otpNumber,status:o.status}));Ce(t,{head:[["Trace Date","Trace Number","Customer ID","Trace Type","Bank Code","OTP Number","Status"]],body:e.map(o=>[o.traceDate,o.traceNumber,o.customerId,o.traceType,o.bankCode,o.otpNumber,o.status])}),t.save(`otpcheck-log${new Date().toDateString()}.pdf`)}static \u0275fac=function(e){return new(e||i)(g(G))};static \u0275cmp=f({type:i,selectors:[["app-otpcheck"]],standalone:!1,features:[q],decls:9,vars:3,consts:[["noData",""],[1,"container-fluid","py-4","d-flex","flex-column","vh-100"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"mb-0"],[3,"filterChange"],["class","d-flex justify-content-end mb-2",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-end","mb-2"],["role","button",1,"btn-link","text-muted","small","text-decoration-none",3,"click"],[1,"bi","bi-file-earmark-pdf","me-1"],[3,"models"],[1,"d-flex","justify-content-center","align-items-center","h-100","text-muted","text-center","px-4"],[1,"bi","bi-search","display-6","d-block","mb-2"],[4,"ngIf"]],template:function(e,o){if(e&1){let d=N();n(0,"div",1)(1,"div",2)(2,"h2",3),p(3,"OTP Check Logs"),r()(),n(4,"app-otpcheck-filterbar",4),b("filterChange",function(ge){return D(d),w(o.onFilterChange(ge))}),r(),s(5,Ee,4,0,"div",5)(6,De,2,1,"ng-container",6)(7,Pe,5,2,"ng-template",null,0,K),r()}if(e&2){let d=z(8);a(5),m("ngIf",o.models.length>0),a(),m("ngIf",o.models.length>0)("ngIfElse",d)}},dependencies:[U,x,_],encapsulation:2})};var Me=[{path:"",component:E}],ve=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=H({type:i});static \u0275inj=A({providers:[u,F],imports:[ue,J,W.forChild(Me),de]})};export{ve as OtpCheckModule};
