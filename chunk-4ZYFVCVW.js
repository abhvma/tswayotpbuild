import{a as F,b as we,c as y}from"./chunk-HM4RWMBY.js";import{a as de,b as ce}from"./chunk-FE2QEPAY.js";import{b as me}from"./chunk-KYXZOB3F.js";import{b as pe}from"./chunk-YEATP2JA.js";import{a as le,c as ue}from"./chunk-2WXLJHYT.js";import"./chunk-XFLVNJYL.js";import{a as se}from"./chunk-HVPVQXOI.js";import{A as g,Ab as Y,B as b,Bb as ee,Ca as L,Cb as te,D as P,Db as re,E as v,Eb as ie,Fb as ne,Ib as oe,Jb as ae,Ma as S,N as a,Na as h,Oa as $,R as f,U as _,V as D,Y as V,Z as d,_a as z,aa as l,ea as o,fa as i,ga as p,ha as R,hb as H,ia as j,ib as K,ja as w,jb as Z,ka as u,kb as J,la as c,sa as q,ta as s,u as k,ua as C,va as B,wa as G,wb as Q,xb as I,yb as W,z as A,zb as X}from"./chunk-43RY7LHR.js";import{f as be,h as x}from"./chunk-ENRHZQ2S.js";var _e=be(we());var E=class{static password(r={}){return e=>{let n=e.value;if(typeof n!="string")return null;let m={};return r.length&&n.length<r.length&&(m.minLength={requiredLength:r.length,actualLength:n.length}),r.upper&&!/[A-Z]/.test(n)&&(m.uppercase=!0),r.lower&&!/[a-z]/.test(n)&&(m.lowercase=!0),r.special&&!/[!@#$%^&*(),.?":{}|<>]/.test(n)&&(m.specialChar=!0),r.digit&&!/[0-9]/.test(n)&&(m.digit=!0),Object.keys(m).length>0?m:null}}};function Ue(t,r){if(t&1&&(o(0,"option",21),s(1),i()),t&2){let e=r.$implicit;l("value",e.code),a(),C(e.name)}}function xe(t,r){t&1&&(o(0,"div",22),s(1," Branch Name is required "),i())}function Se(t,r){t&1&&(o(0,"div",22),s(1," Username is required and must be at least 3 characters long. "),i())}function ye(t,r){t&1&&(o(0,"div",23),s(1," The username already exists. "),i())}function Ee(t,r){if(t&1&&(o(0,"div"),s(1),i()),t&2){let e=c().ngIf;a(),B(" Password must be at least ",e.minLength.requiredLength," characters ")}}function Ne(t,r){t&1&&(o(0,"div"),s(1," Password must contain at least one uppercase letter "),i())}function Te(t,r){t&1&&(o(0,"div"),s(1," Password must contain at least one lowercase letter "),i())}function Me(t,r){t&1&&(o(0,"div"),s(1," Password must contain at least one special character "),i())}function Fe(t,r){t&1&&(o(0,"div"),s(1," Password must contain at least one number "),i())}function Oe(t,r){if(t&1&&(o(0,"div"),d(1,Ee,2,1,"div",24)(2,Ne,2,0,"div",24)(3,Te,2,0,"div",24)(4,Me,2,0,"div",24)(5,Fe,2,0,"div",24),i()),t&2){let e=r.ngIf;a(),l("ngIf",e.minLength),a(),l("ngIf",e.uppercase),a(),l("ngIf",e.lowercase),a(),l("ngIf",e.specialChar),a(),l("ngIf",e.digit)}}function ke(t,r){if(t&1&&(o(0,"div",22),d(1,Oe,6,5,"div",24),i()),t&2){let e,n=c();a(),l("ngIf",(e=n.userForm.get("password"))==null?null:e.errors)}}function Ae(t,r){t&1&&(o(0,"div",22),s(1," New Password didn't match "),i())}var N=class t{constructor(r,e,n){this.fb=r;this.authService=e;this.toast=n;this.userForm=this.fb.group({userId:["",I.required],password:["",[I.required,E.password({digit:!0,lower:!0,upper:!0,length:8,special:!0})]],repeatPassword:["",I.required],branchName:["",I.required]})}model;save=new v;cancel=new v;bankOptions=K;bankNameMap=H;branchOptions=J;branchNameMap=Z;modalTitle="Add User";userForm;eCustomerStatus=de;eOtpType=ce;dialogRef;userNotUnique=!1;ngOnInit(){}ngOnChanges(r){this.modalTitle=(this.model,"Edit User");let e=this.model||new F;this.userForm.patchValue({userId:e.userId,branchName:this.authService.authUser()?.branchName})}onSave(){return x(this,null,function*(){let r=new se;try{if(r.show(),this.userNotUnique=!1,this.userForm.valid){let e=new F;if(e.fill(this.userForm.value),e.password=(0,_e.sha256)(e.password),this.model)yield this.authService.update(e),this.toast.success("Customer information updated successfully.");else{if(!(yield this.authService.verifyUserIsUnique(e))){r.hide(),this.userNotUnique=!0;return}yield this.authService.create(e),this.toast.success("Customer added successfully.")}this.save.emit(this.userForm.value),this.dialogRef.close(e),r.hide()}else this.userForm.markAllAsTouched()}catch{}finally{r.hide()}})}onCancel(){this.dialogRef.close(void 0),this.cancel.emit()}get formControls(){return this.userForm.controls}static \u0275fac=function(e){return new(e||t)(f(oe),f(y),f(le))};static \u0275cmp=_({type:t,selectors:[["app-user-create-modal"]],inputs:{model:"model"},outputs:{save:"save",cancel:"cancel"},standalone:!1,features:[G([me]),A],decls:34,vars:8,consts:[[1,"modal-content"],[1,"tsway-modal-header"],[1,"tsway-modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"tsway-modal-body"],[1,"row",3,"formGroup"],[1,"mb-3","col-md-12"],["for","branchName",1,"form-label"],["id","branchName","formControlName","branchName",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["class","text-danger",4,"ngIf"],["for","userId",1,"form-label"],["id","userId","formControlName","userId","placeholder","Enter Username",1,"form-control"],["class","text-danger","role","alert",4,"ngIf"],["for","password",1,"form-label"],["type","password","id","password","formControlName","password","placeholder","Password",1,"form-control"],["for","repeatPassword",1,"form-label"],["type","password","id","repeatPassword","formControlName","repeatPassword","placeholder","Repeat Password",1,"form-control"],[1,"tsway-modal-footer"],[1,"btn","btn-danger","me-2","text-white",3,"click"],[1,"btn","btn-primary",3,"click","disabled"],[3,"value"],[1,"text-danger"],["role","alert",1,"text-danger"],[4,"ngIf"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"h5",2),s(3,"Add User"),i(),o(4,"button",3),u("click",function(){return n.onCancel()}),i()(),o(5,"div",4)(6,"form",5)(7,"div",6)(8,"label",7),s(9,"Branch Name"),i(),o(10,"select",8),d(11,Ue,2,2,"option",9),i(),d(12,xe,2,0,"div",10),i(),o(13,"div",6)(14,"label",11),s(15,"Username"),i(),p(16,"input",12),d(17,Se,2,0,"div",10)(18,ye,2,0,"div",13),i(),o(19,"div",6)(20,"label",14),s(21,"Password"),i(),p(22,"input",15),d(23,ke,2,1,"div",10),i(),o(24,"div",6)(25,"label",16),s(26,"Repeat Password"),i(),p(27,"input",17),d(28,Ae,2,0,"div",10),i()()(),o(29,"div",18)(30,"button",19),u("click",function(){return n.onCancel()}),s(31," Cancel "),i(),o(32,"button",20),u("click",function(){return n.onSave()}),s(33,"Save"),i()()()),e&2&&(a(6),l("formGroup",n.userForm),a(5),l("ngForOf",n.branchOptions),a(),l("ngIf",n.formControls.branchName.touched&&n.formControls.branchName.invalid),a(5),l("ngIf",n.formControls.userId.touched&&n.formControls.userId.invalid),a(),l("ngIf",n.userNotUnique),a(5),l("ngIf",n.formControls.password.touched&&n.formControls.password.invalid),a(5),l("ngIf",n.formControls.repeatPassword.touched&&n.formControls.repeatPassword.value!==n.formControls.password.value),a(4),l("disabled",n.userForm.invalid))},dependencies:[S,h,Y,ie,ne,Q,re,W,X,ee,te],styles:["[_nghost-%COMP%]{font-size:.875rem!important}"]})};function Pe(t,r){if(t&1&&(o(0,"th",3),s(1),i()),t&2){let e=r.$implicit;l("width",e.width),a(),C(e.label)}}function De(t,r){if(t&1){let e=w();o(0,"button",5),u("click",function(){g(e);let m=c(),U=m.$implicit,he=m.index,ge=c();return b(ge.deleteClick.emit({model:U,index:he}))}),p(1,"i",6),s(2," Delete "),i()}}function Ve(t,r){if(t&1&&(o(0,"tr")(1,"td"),s(2),i(),o(3,"td"),s(4),i(),o(5,"td"),d(6,De,3,0,"button",4),i()()),t&2){let e=r.$implicit,n=c();a(2),C(e.userId),a(2),C(e.branchName),a(2),l("ngIf",n.currentUser.userId!==e.userId)}}var T=class t{models=[];editClick=new v;deleteClick=new v;currentUser;columns=[{label:"Username",width:"10%"},{label:"Branch",width:"60%"},{label:"Action",width:"15%"}];static \u0275fac=function(e){return new(e||t)};static \u0275cmp=_({type:t,selectors:[["app-user-table"]],inputs:{models:"models",currentUser:"currentUser"},outputs:{editClick:"editClick",deleteClick:"deleteClick"},standalone:!1,decls:6,vars:2,consts:[[1,"tsway-datatable","striped"],[3,"width",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"width"],["class","btn btn-sm btn-danger btn-long text-white",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-danger","btn-long","text-white",3,"click"],[1,"bi","bi-trash"]],template:function(e,n){e&1&&(o(0,"table",0)(1,"thead")(2,"tr"),d(3,Pe,2,2,"th",1),i()(),o(4,"tbody"),d(5,Ve,7,3,"tr",2),i()()),e&2&&(a(3),l("ngForOf",n.columns),a(2),l("ngForOf",n.models))},dependencies:[S,h],encapsulation:2})};function je(t,r){if(t&1){let e=w();R(0),o(1,"app-user-table",8),u("deleteClick",function(m){g(e);let U=c();return b(U.deleteModel(m))}),i(),j()}if(t&2){let e=c();a(),l("models",e.models)("currentUser",e.currentUser)}}function qe(t,r){t&1&&(o(0,"div",9)(1,"div"),p(2,"i",10),o(3,"p",4),s(4,"No Users found."),i()()())}var M=class t extends pe{currentUser;constructor(r,e){super(e),this.modelService=r}ngOnInit(){this.loadModels().then(),this.currentUser=this.modelService.authUser()}applyFilters(){}openDialog(r){return x(this,null,function*(){(yield this.dialog.open(N,{model:r},{width:"22.5%"})).closed.subscribe(n=>this.models.push(n))})}static \u0275fac=function(e){return new(e||t)(f(y),f(P))};static \u0275cmp=_({type:t,selectors:[["app-user"]],standalone:!1,features:[V],decls:11,vars:2,consts:[["button",""],["noData",""],[1,"container-fluid","py-4","d-flex","flex-column","vh-100"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"mb-0"],[1,"btn","btn-danger","text-white",3,"click"],[1,"bi","bi-plus-lg","me-1"],[4,"ngIf","ngIfElse"],[3,"deleteClick","models","currentUser"],[1,"d-flex","justify-content-center","align-items-center","h-100","text-muted","text-center","px-4"],[1,"bi","bi-search","display-6","d-block","mb-2"]],template:function(e,n){if(e&1){let m=w();o(0,"div",2)(1,"div",3)(2,"h2",4),s(3,"Users"),i(),o(4,"button",5,0),u("click",function(){return g(m),b(n.addModel())}),p(6,"i",6),s(7,"Add New User "),i()(),d(8,je,2,2,"ng-container",7)(9,qe,5,0,"ng-template",null,1,L),i()}if(e&2){let m=q(10);a(8),l("ngIf",n.models.length>0)("ngIfElse",m)}},dependencies:[h,T],encapsulation:2})};var Be=[{path:"",component:M}],Ce=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=D({type:t});static \u0275inj=k({imports:[ue,$,z.forChild(Be),ae]})};export{Ce as UserModule};
