import{a as ee,b as ve,c as v}from"./chunk-UQ37YOMU.js";import{a as ae,b as z,c as F}from"./chunk-DZSZFHVS.js";import"./chunk-KH7BRNI5.js";import{a as T,b as se,c as le}from"./chunk-NIGCFUHO.js";import"./chunk-UVELQQGN.js";import{a as w}from"./chunk-HVPVQXOI.js";import{Ab as I,Bb as E,Cb as ie,Db as ne,E as B,Eb as oe,Hb as O,Ib as re,Ma as M,N as s,Na as Y,Oa as J,R as m,U as p,V as S,Wa as Q,Ya as W,Z as f,Za as X,_a as q,aa as d,ca as H,ea as t,fa as i,ga as l,ib as Z,ka as c,la as $,ta as r,u as C,ua as P,ub as x,va as u,vb as g,wa as y,wb as _,xa as K,xb as N,yb as k,zb as te}from"./chunk-7DNIHSJB.js";import{f as ue,h as V}from"./chunk-ENRHZQ2S.js";var he=()=>({exact:!0});function be(n,o){if(n&1&&(t(0,"li",6)(1,"a",11),l(2,"i"),r(3),i()()),n&2){let e=o.$implicit;s(),d("routerLink",e.path)("routerLinkActiveOptions",K(5,he)),s(),H("bi "+e.icon),s(),u(" ",e.label," ")}}var A=class n{constructor(o){this.authService=o}brandName="OTP Management System";navLinks=[{label:"Dashboard",path:"/manage",icon:"bi-speedometer2"},{label:"Customers",path:"/manage/customers",icon:"bi-people"},{label:"Transaction Logs",path:"/manage/transactions",icon:"bi-file-earmark-text"},{label:"OTP Logs",path:"/manage/otplogs",icon:"bi-shield-lock"},{label:"Settings",path:"/manage/settings",icon:"bi-gear"}];logoutClick(){this.authService.logout()}static \u0275fac=function(e){return new(e||n)(m(v))};static \u0275cmp=p({type:n,selectors:[["app-navbar"]],standalone:!1,decls:15,vars:2,consts:[[1,"sidebar","d-flex","flex-column","p-3","bg-primary","text-white"],[1,"sidebar-rounded"],[1,"brand-container"],[1,"brandname","fs-5","fw-bold","text-decoration-none"],[1,"nav","nav-pills","flex-column"],["class","nav-item mb-2",4,"ngFor","ngForOf"],[1,"nav-item","mb-2"],["role","button",1,"nav-link","d-flex","align-items-center","gap-2",3,"click"],[1,"bi","bi-box-arrow-right"],["role","button",1,"nav-link","d-flex","align-items-center","gap-2"],[1,"bi","bi-file-earmark-pdf"],["routerLinkActive","active",1,"nav-link","d-flex","align-items-center","gap-2",3,"routerLink","routerLinkActiveOptions"]],template:function(e,a){e&1&&(t(0,"aside",0)(1,"div",1)(2,"div",2)(3,"a",3),r(4),i()(),t(5,"ul",4),f(6,be,4,6,"li",5),t(7,"li",6)(8,"a",7),c("click",function(){return a.logoutClick()}),l(9,"i",8),r(10," Logout"),i()(),t(11,"li",6)(12,"a",9),l(13,"i",10),r(14," Download Manual"),i()()()()()),e&2&&(s(4),u(" ",a.brandName," "),s(2),d("ngForOf",a.navLinks))},dependencies:[M,W,X],styles:[".sidebar[_ngcontent-%COMP%]{position:fixed;height:100vh;width:16rem;top:0;left:0;padding-top:1rem;z-index:1000}.brand-container[_ngcontent-%COMP%]{margin-bottom:2rem}.brandname[_ngcontent-%COMP%]{color:var(--bs-white-rgb);margin-bottom:3rem}.nav-link.active[_ngcontent-%COMP%]{background-color:#0d6efd;color:#fff!important}.nav-link[_ngcontent-%COMP%]{color:var(--bs-white);background-color:transparent;border-radius:.375rem;transition:background-color .2s ease,color .2s ease}.nav-link[_ngcontent-%COMP%]:hover{background-color:rgba(var(--bs-white-rgb),.1);color:var(--bs-white)}.nav-link.active[_ngcontent-%COMP%]{background-color:var(--bs-danger);color:var(--bs-white)!important}.nav-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem}"]})};var pe=ue(ve());function Pe(n,o){if(n&1&&(t(0,"div",17),r(1),i()),n&2){let e=$();s(),P(e.errorMessage)}}function ye(n,o){n&1&&(t(0,"div",17),r(1," Old Password is required "),i())}function Me(n,o){n&1&&(t(0,"div",17),r(1," New password is required "),i())}function xe(n,o){n&1&&(t(0,"div",17),r(1," New password is required "),i())}function _e(n,o){n&1&&(t(0,"div",17),r(1," New Password didn't match "),i())}var R=class n{constructor(o,e,a){this.fb=o;this.toast=e;this.userService=a;this.form=this.fb.group({oldPassword:["",g.required],newPassword:["",[g.required,g.minLength(8)]],repeatPassword:["",[g.required,g.minLength(8)]]})}model;save=new B;cancel=new B;modalTitle="Change Password";errorMessage="";form;dialogRef;customerNotUnique=!1;onSave(){this.errorMessage="";let o=new w;this.form.value.oldPassword!==this.model.plainPassword&&(this.errorMessage="Your old password didn't match. Please try again");let a=new ee;a.fill({userId:this.model?.userId,password:(0,pe.sha256)(this.form.value.newPassword),branchName:this.model?.branchName,plainPassword:this.form.value.newPassword}),o.show(),this.userService.update(a).then(()=>{this.toast.success("Password updated successfully"),this.dialogRef.close(void 0)}).finally(()=>{o.hide()})}onCancel(){this.dialogRef.close(void 0),this.cancel.emit()}get formControls(){return this.form.controls}static \u0275fac=function(e){return new(e||n)(m(O),m(T),m(v))};static \u0275cmp=p({type:n,selectors:[["app-password-change-modal"]],inputs:{model:"model"},outputs:{save:"save",cancel:"cancel"},standalone:!1,features:[y([])],decls:29,vars:6,consts:[[1,"modal-content"],[1,"tsway-modal-header"],[1,"tsway-modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"tsway-modal-body"],["class","text-danger",4,"ngIf"],[1,"row",3,"formGroup"],[1,"mb-3","col-md-12"],["for","oldPasswod",1,"form-label"],["type","password","id","oldPassword","formControlName","oldPassword","placeholder","Old Password",1,"form-control"],["for","newPassword",1,"form-label"],["type","password","id","newPassword","formControlName","newPassword","placeholder","New Password",1,"form-control"],["for","repeatPassword",1,"form-label"],["type","password","id","repeatPassword","formControlName","repeatPassword","placeholder","Repeat Password",1,"form-control"],[1,"tsway-modal-footer"],[1,"btn","btn-danger","me-2","text-white",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"text-danger"]],template:function(e,a){e&1&&(t(0,"div",0)(1,"div",1)(2,"h5",2),r(3,"Change Password"),i(),t(4,"button",3),c("click",function(){return a.onCancel()}),i()(),t(5,"div",4),f(6,Pe,2,1,"div",5),t(7,"form",6)(8,"div",7)(9,"label",8),r(10,"Old Password"),i(),l(11,"input",9),f(12,ye,2,0,"div",5),i(),t(13,"div",7)(14,"label",10),r(15,"New Password"),i(),l(16,"input",11),f(17,Me,2,0,"div",5),i(),t(18,"div",7)(19,"label",12),r(20,"Repeat Password"),i(),l(21,"input",13),f(22,xe,2,0,"div",5)(23,_e,2,0,"div",5),i()()(),t(24,"div",14)(25,"button",15),c("click",function(){return a.onCancel()}),r(26," Cancel "),i(),t(27,"button",16),c("click",function(){return a.onSave()}),r(28,"Save"),i()()()),e&2&&(s(6),d("ngIf",a.errorMessage),s(),d("formGroup",a.form),s(5),d("ngIf",a.formControls.oldPassword.touched&&a.formControls.oldPassword.invalid),s(5),d("ngIf",a.formControls.newPassword.touched&&a.formControls.newPassword.invalid),s(5),d("ngIf",a.formControls.repeatPassword.touched&&a.formControls.repeatPassword.invalid),s(),d("ngIf",a.formControls.repeatPassword.touched&&a.formControls.repeatPassword.value!==a.formControls.newPassword.value))},dependencies:[k,x,_,N,I,E,Y],styles:["[_nghost-%COMP%]{font-size:.875rem!important}"]})};var L=class n{constructor(o,e,a){this.authService=o;this.ctxMenuService=e;this.dialog=a}username="";navItems=[{label:"Change Password",enabled:!0,icon:"bi bi-key",name:"changepassword"}];ngOnInit(){this.username=this.authService.authUser()?.userId||""}ngAfterViewInit(){this.ctxMenuService.itemSelected.subscribe(o=>{o.name==="changepassword"&&this.dialog.open(R,{model:this.authService.authUser()},{width:"30%"})})}onAvatarClick(o){this.ctxMenuService.show(this.navItems,o.target,"bottom")}static \u0275fac=function(e){return new(e||n)(m(v),m(ae),m(se))};static \u0275cmp=p({type:n,selectors:[["app-top-navbar"]],standalone:!1,decls:7,vars:2,consts:[[1,"navbar","navbar-light","bg-light"],[1,"container-fluid","justify-content-end"],["role","button",1,"d-flex","align-items-center",3,"click"],[1,"avatar","bg-primary","text-white","rounded-circle","d-flex","align-items-center","justify-content-center","me-2"],[1,"fw-bold"]],template:function(e,a){e&1&&(t(0,"nav",0)(1,"div",1)(2,"div",2),c("click",function(fe){return a.onAvatarClick(fe)}),t(3,"div",3),r(4),i(),t(5,"span",4),r(6),i()()()()),e&2&&(s(4),u(" ",a.username.charAt(0)," "),s(2),P(a.username))},styles:[".navbar[_ngcontent-%COMP%]{width:100%;position:fixed;padding-left:24px;z-index:900}.navbar[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:40px;height:40px;font-weight:700}"]})};var G=class n{static \u0275fac=function(e){return new(e||n)};static \u0275cmp=p({type:n,selectors:[["app-admin"]],standalone:!1,decls:5,vars:0,consts:[[1,"d-flex","flex-row"],[1,"main-content","flex-fill"]],template:function(e,a){e&1&&(t(0,"div",0),l(1,"app-navbar")(2,"app-top-navbar"),t(3,"div",1),l(4,"router-outlet"),i()())},dependencies:[Q,A,L],styles:[".main-content[_ngcontent-%COMP%]{margin-top:56px;margin-left:17rem}"]})};function ke(n,o){if(n&1&&(t(0,"option",22),r(1),i()),n&2){let e=o.$implicit;d("value",e.code),s(),u(" ",e.name," ")}}var j=class n{constructor(o,e,a){this.settingService=o;this.toast=a;this.formGroup=e.group({id:[""],bankCode:[""],branchCode:[""],otpRetryLimit:[""],smtpServer:[""],smtpPort:[""],smtpUser:[""],smtpPass:[""]})}bankOptions=Z;branchOptions=[];settingModel=new z;formGroup;ngOnInit(){return V(this,null,function*(){let o=new w;try{let e=yield this.settingService.get();e.length>0&&(this.settingModel=e[0],this.formGroup.patchValue(this.settingModel))}catch{}finally{o.hide()}})}saveSettings(){return V(this,null,function*(){let o=new w;try{let e=new z;e.fill(this.formGroup.value),e.id=this.settingModel.id,o.show(),e.id?yield this.settingService.update(e):yield this.settingService.create(e),this.toast.success("Settings updated.")}finally{o.hide()}})}static \u0275fac=function(e){return new(e||n)(m(F),m(O),m(T))};static \u0275cmp=p({type:n,selectors:[["app-settings"]],standalone:!1,features:[y([F])],decls:60,vars:2,consts:[[1,"container","py-5",3,"formGroup"],[1,"mb-4","fw-semibold"],[1,"mb-5"],[1,"tsway-card"],[1,"tsway-card-header"],[1,"mb-0"],[1,"tsway-card-body","pt-3","pe-3","ps-3"],[1,"mb-3","row"],[1,"col-sm-4","col-form-label"],[1,"col-sm-8"],["formControlName","otpRetryLimit","type","text","placeholder","Enter max retry limit",1,"form-control"],[1,"tsway-card","tsway-card"],["formControlName","bankCode","placeholder","Enter default bank name or code",1,"form-control"],["disabled",""],[3,"value",4,"ngFor","ngForOf"],[1,"text-muted","mb-3"],["formControlName","smtpServer","type","text","placeholder","smtp.example.com",1,"form-control"],["formControlName","smtpPort","type","number","placeholder","e.g. 587",1,"form-control"],["formControlName","smtpUser","type","text","placeholder","Enter username",1,"form-control"],["formControlName","smtpPass","type","password","placeholder","Enter password",1,"form-control"],[1,"text-end"],[1,"btn","btn-primary","btn-lg","px-5",3,"click"],[3,"value"]],template:function(e,a){e&1&&(t(0,"form",0)(1,"div")(2,"h2",1),r(3,"Settings"),i()(),t(4,"section",2)(5,"div",3)(6,"div",4)(7,"h6",5),r(8,"OTP Settings"),i()(),t(9,"div",6)(10,"div",7)(11,"label",8),r(12,"Max Retry Limit for OTPs"),i(),t(13,"div",9),l(14,"input",10),i()()()()(),t(15,"section",2)(16,"div",11)(17,"div",4)(18,"h6",5),r(19,"Bank Settings"),i()(),t(20,"div",6)(21,"div",7)(22,"label",8),r(23,"Default Bank"),i(),t(24,"div",9)(25,"select",12)(26,"option",13),r(27,"Select One"),i(),f(28,ke,2,2,"option",14),i()()()()()(),t(29,"section",2)(30,"div",3)(31,"div",4)(32,"h6",5),r(33,"System Settings"),i()(),t(34,"div",6)(35,"h6",15),r(36,"SMTP Settings"),i(),t(37,"div",7)(38,"label",8),r(39,"SMTP Server"),i(),t(40,"div",9),l(41,"input",16),i()(),t(42,"div",7)(43,"label",8),r(44,"SMTP Port"),i(),t(45,"div",9),l(46,"input",17),i()(),t(47,"div",7)(48,"label",8),r(49,"SMTP Username"),i(),t(50,"div",9),l(51,"input",18),i()(),t(52,"div",7)(53,"label",8),r(54,"SMTP Password"),i(),t(55,"div",9),l(56,"input",19),i()()()()(),t(57,"div",20)(58,"button",21),c("click",function(){return a.saveSettings()}),r(59,"Save Settings"),i()()()),e&2&&(d("formGroup",a.formGroup),s(28),d("ngForOf",a.bankOptions))},dependencies:[M,k,ne,oe,x,te,ie,_,N,I,E],encapsulation:2})};var Ie=[{path:"",component:G,children:[{path:"",loadChildren:()=>import("./chunk-LSLDZBQC.js").then(n=>n.DashboardModule)},{path:"customers",loadChildren:()=>import("./chunk-R6Z2XSYF.js").then(n=>n.HomeModule)},{path:"transactions",loadChildren:()=>import("./chunk-LY6FDKLR.js").then(n=>n.TransactionLogModule)},{path:"otplogs",loadChildren:()=>import("./chunk-RBYN6ORE.js").then(n=>n.OtpCheckModule)},{path:"settings",component:j}]}],U=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=S({type:n});static \u0275inj=C({imports:[q.forChild(Ie),q]})};var ce=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=S({type:n});static \u0275inj=C({imports:[U,le,J,re]})};export{ce as AdminModule};
