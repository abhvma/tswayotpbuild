import{a as pe,b as _e,c as b}from"./chunk-NROHXBU2.js";import{a as he}from"./chunk-5O7X5DJA.js";import"./chunk-KH7BRNI5.js";import{a as be,b as we,c as Se}from"./chunk-4T4JXQH6.js";import{a as T}from"./chunk-IYAOVYZQ.js";import{a as H}from"./chunk-HVPVQXOI.js";import{$a as O,Ab as G,Bb as U,Cb as fe,Db as ue,E as X,Eb as ve,Hb as V,Ib as ge,Ma as E,N as s,Na as ie,Oa as oe,R as d,U as c,V as _,Wa as re,Ya as ae,Z as f,Za as se,_a as Z,aa as l,ca as ee,ea as i,fa as t,ga as m,ib as me,ka as u,la as te,nb as D,ob as F,pb as le,qb as de,t as x,ta as r,tb as A,u as k,ua as I,ub as R,va as v,vb as h,w as M,wa as N,wb as j,xa as ne,xb as L,yb as B,zb as ce}from"./chunk-MCVMA3LQ.js";import{f as Me,g as y,h as W}from"./chunk-ENRHZQ2S.js";var Ne=()=>({exact:!0});function Ee(e,o){if(e&1&&(i(0,"li",6)(1,"a",11),m(2,"i"),r(3),t()()),e&2){let n=o.$implicit;s(),l("routerLink",n.path)("routerLinkActiveOptions",ne(5,Ne)),s(),ee("bi "+n.icon),s(),v(" ",n.label," ")}}var q=class e{constructor(o){this.authService=o}brandName="OTP Management System";navLinks=[{label:"Dashboard",path:"/manage",icon:"bi-speedometer2"},{label:"Customers",path:"/manage/customers",icon:"bi-people"},{label:"Transaction Logs",path:"/manage/transactions",icon:"bi-file-earmark-text"},{label:"OTP Logs",path:"/manage/otplogs",icon:"bi-shield-lock"},{label:"Settings",path:"/manage/settings",icon:"bi-gear"}];logoutClick(){this.authService.logout()}static \u0275fac=function(n){return new(n||e)(d(b))};static \u0275cmp=c({type:e,selectors:[["app-navbar"]],standalone:!1,decls:15,vars:2,consts:[[1,"sidebar","d-flex","flex-column","p-3","bg-primary","text-white"],[1,"sidebar-rounded"],[1,"brand-container"],[1,"brandname","fs-5","fw-bold","text-decoration-none"],[1,"nav","nav-pills","flex-column"],["class","nav-item mb-2",4,"ngFor","ngForOf"],[1,"nav-item","mb-2"],["role","button",1,"nav-link","d-flex","align-items-center","gap-2",3,"click"],[1,"bi","bi-box-arrow-right"],["role","button",1,"nav-link","d-flex","align-items-center","gap-2"],[1,"bi","bi-file-earmark-pdf"],["routerLinkActive","active",1,"nav-link","d-flex","align-items-center","gap-2",3,"routerLink","routerLinkActiveOptions"]],template:function(n,a){n&1&&(i(0,"aside",0)(1,"div",1)(2,"div",2)(3,"a",3),r(4),t()(),i(5,"ul",4),f(6,Ee,4,6,"li",5),i(7,"li",6)(8,"a",7),u("click",function(){return a.logoutClick()}),m(9,"i",8),r(10," Logout"),t()(),i(11,"li",6)(12,"a",9),m(13,"i",10),r(14," Download Manual"),t()()()()()),n&2&&(s(4),v(" ",a.brandName," "),s(2),l("ngForOf",a.navLinks))},dependencies:[E,ae,se],styles:[".sidebar[_ngcontent-%COMP%]{position:fixed;height:100vh;width:16rem;top:0;left:0;padding-top:1rem;z-index:1000}.brand-container[_ngcontent-%COMP%]{margin-bottom:2rem}.brandname[_ngcontent-%COMP%]{color:var(--bs-white-rgb);margin-bottom:3rem}.nav-link.active[_ngcontent-%COMP%]{background-color:#0d6efd;color:#fff!important}.nav-link[_ngcontent-%COMP%]{color:var(--bs-white);background-color:transparent;border-radius:.375rem;transition:background-color .2s ease,color .2s ease}.nav-link[_ngcontent-%COMP%]:hover{background-color:rgba(var(--bs-white-rgb),.1);color:var(--bs-white)}.nav-link.active[_ngcontent-%COMP%]{background-color:var(--bs-danger);color:var(--bs-white)!important}.nav-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem}"]})};var ye=Me(_e());function De(e,o){if(e&1&&(i(0,"div",17),r(1),t()),e&2){let n=te();s(),I(n.errorMessage)}}function Fe(e,o){e&1&&(i(0,"div",17),r(1," Old Password is required "),t())}function Ae(e,o){e&1&&(i(0,"div",17),r(1," New password is required "),t())}function Re(e,o){e&1&&(i(0,"div",17),r(1," New password is required "),t())}function je(e,o){e&1&&(i(0,"div",17),r(1," New Password didn't match "),t())}var K=class e{constructor(o,n,a){this.fb=o;this.toast=n;this.userService=a;this.form=this.fb.group({oldPassword:["",h.required],newPassword:["",[h.required,h.minLength(8)]],repeatPassword:["",[h.required,h.minLength(8)]]})}model;save=new X;cancel=new X;modalTitle="Change Password";errorMessage="";form;dialogRef;customerNotUnique=!1;onSave(){this.errorMessage="";let o=new H;this.form.value.oldPassword!==this.model.plainPassword&&(this.errorMessage="Your old password didn't match. Please try again");let a=new pe;a.fill({userId:this.model?.userId,password:(0,ye.sha256)(this.form.value.newPassword),branchName:this.model?.branchName,plainPassword:this.form.value.newPassword}),o.show(),this.userService.update(a).then(()=>{this.toast.success("Password updated successfully"),this.dialogRef.close(void 0)}).finally(()=>{o.hide()})}onCancel(){this.dialogRef.close(void 0),this.cancel.emit()}get formControls(){return this.form.controls}static \u0275fac=function(n){return new(n||e)(d(V),d(be),d(b))};static \u0275cmp=c({type:e,selectors:[["app-password-change-modal"]],inputs:{model:"model"},outputs:{save:"save",cancel:"cancel"},standalone:!1,features:[N([])],decls:29,vars:6,consts:[[1,"modal-content"],[1,"tsway-modal-header"],[1,"tsway-modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"tsway-modal-body"],["class","text-danger",4,"ngIf"],[1,"row",3,"formGroup"],[1,"mb-3","col-md-12"],["for","oldPasswod",1,"form-label"],["type","password","id","oldPassword","formControlName","oldPassword","placeholder","Old Password",1,"form-control"],["for","newPassword",1,"form-label"],["type","password","id","newPassword","formControlName","newPassword","placeholder","New Password",1,"form-control"],["for","repeatPassword",1,"form-label"],["type","password","id","repeatPassword","formControlName","repeatPassword","placeholder","Repeat Password",1,"form-control"],[1,"tsway-modal-footer"],[1,"btn","btn-danger","me-2","text-white",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"text-danger"]],template:function(n,a){n&1&&(i(0,"div",0)(1,"div",1)(2,"h5",2),r(3,"Change Password"),t(),i(4,"button",3),u("click",function(){return a.onCancel()}),t()(),i(5,"div",4),f(6,De,2,1,"div",5),i(7,"form",6)(8,"div",7)(9,"label",8),r(10,"Old Password"),t(),m(11,"input",9),f(12,Fe,2,0,"div",5),t(),i(13,"div",7)(14,"label",10),r(15,"New Password"),t(),m(16,"input",11),f(17,Ae,2,0,"div",5),t(),i(18,"div",7)(19,"label",12),r(20,"Repeat Password"),t(),m(21,"input",13),f(22,Re,2,0,"div",5)(23,je,2,0,"div",5),t()()(),i(24,"div",14)(25,"button",15),u("click",function(){return a.onCancel()}),r(26," Cancel "),t(),i(27,"button",16),u("click",function(){return a.onSave()}),r(28,"Save"),t()()()),n&2&&(s(6),l("ngIf",a.errorMessage),s(),l("formGroup",a.form),s(5),l("ngIf",a.formControls.oldPassword.touched&&a.formControls.oldPassword.invalid),s(5),l("ngIf",a.formControls.newPassword.touched&&a.formControls.newPassword.invalid),s(5),l("ngIf",a.formControls.repeatPassword.touched&&a.formControls.repeatPassword.invalid),s(),l("ngIf",a.formControls.repeatPassword.touched&&a.formControls.repeatPassword.value!==a.formControls.newPassword.value))},dependencies:[B,R,j,L,G,U,ie],styles:["[_nghost-%COMP%]{font-size:.875rem!important}"]})};var $=class e{constructor(o,n,a){this.authService=o;this.ctxMenuService=n;this.dialog=a}username="";navItems=[{label:"Change Password",enabled:!0,icon:"bi bi-key",name:"changepassword"}];ngOnInit(){this.username=this.authService.authUser()?.userId||""}ngAfterViewInit(){this.ctxMenuService.itemSelected.subscribe(o=>{o.name==="changepassword"&&this.dialog.open(K,{model:this.authService.authUser()},{width:"30%"})})}onAvatarClick(o){this.ctxMenuService.show(this.navItems,o.target,"bottom")}static \u0275fac=function(n){return new(n||e)(d(b),d(he),d(we))};static \u0275cmp=c({type:e,selectors:[["app-top-navbar"]],standalone:!1,decls:7,vars:2,consts:[[1,"navbar","navbar-light","bg-light"],[1,"container-fluid","justify-content-end"],["role","button",1,"d-flex","align-items-center",3,"click"],[1,"avatar","bg-primary","text-white","rounded-circle","d-flex","align-items-center","justify-content-center","me-2"],[1,"fw-bold"]],template:function(n,a){n&1&&(i(0,"nav",0)(1,"div",1)(2,"div",2),u("click",function(ke){return a.onAvatarClick(ke)}),i(3,"div",3),r(4),t(),i(5,"span",4),r(6),t()()()()),n&2&&(s(4),v(" ",a.username.charAt(0)," "),s(2),I(a.username))},styles:[".navbar[_ngcontent-%COMP%]{width:100%;position:fixed;padding-left:24px;z-index:900}.navbar[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:40px;height:40px;font-weight:700}"]})};var Y=class e{static \u0275fac=function(n){return new(n||e)};static \u0275cmp=c({type:e,selectors:[["app-admin"]],standalone:!1,decls:5,vars:0,consts:[[1,"d-flex","flex-row"],[1,"main-content","flex-fill"]],template:function(n,a){n&1&&(i(0,"div",0),m(1,"app-navbar")(2,"app-top-navbar"),i(3,"div",1),m(4,"router-outlet"),t()())},dependencies:[re,q,$],styles:[".main-content[_ngcontent-%COMP%]{margin-top:56px;margin-left:17rem}"]})};var Be={bankCode:"bank_cd",bankName:"bank_name",branchCode:"branch_cd",branchName:"branch_name"},w=class extends O{constructor(){super(),this._mapper=new D(Be)}getSoftDelete(){}bankCode="";bankName="";branchCode="";branchName="";getPrimaryKeyName(){return""}};w=y([F("bankmst")],w);var S=class e extends T{constructor(o){super(o,w)}getName(){return"bank"}static \u0275fac=function(n){return new(n||e)(M(A))};static \u0275prov=x({token:e,factory:e.\u0275fac})};var Ve={id:"id",bankCode:"bank_code",branchCode:"branch_code",otpRetryLimit:"retry_limit",smtpServer:"smtpserver",smtpUser:"smtpuser",smtpPort:"smtpport",smtpPass:"smtppass"},p=class extends O{id="";bankCode="";branchCode="";otpRetryLimit=0;smtpServer="";smtpPass="";smtpPort="";smtpUser="";constructor(){super(),this._mapper=new D(Ve)}getPrimaryKeyName(){return"id"}getSoftDelete(){}};y([de(),le("id")],p.prototype,"id",2),p=y([F("setting")],p);var C=class e extends T{constructor(o){super(o,p)}getName(){return"setting"}static \u0275fac=function(n){return new(n||e)(M(A))};static \u0275prov=x({token:e,factory:e.\u0275fac})};function qe(e,o){if(e&1&&(i(0,"option",26),r(1),t()),e&2){let n=o.$implicit;l("value",n.code),s(),v(" ",n.name," ")}}function ze(e,o){if(e&1&&(i(0,"option",26),r(1),t()),e&2){let n=o.$implicit;l("value",n.branchCode),s(),v(" ",n.branchName," ")}}var J=class e{constructor(o,n,a){this.bankService=o;this.settingService=n;this.formGroup=a.group({id:[""],bankCode:[""],branchCode:[""],otpRetryLimit:[""],smtpServer:[""],smtpPort:[""],smtpUser:[""],smtpPass:[""]})}bankOptions=me;branchOptions=[];settingModel=new p;formGroup;ngOnInit(){return W(this,null,function*(){let o=new H;try{this.branchOptions=yield this.bankService.get();let n=yield this.settingService.get();n.length>0&&(this.settingModel=n[0],this.formGroup.patchValue(this.settingModel))}catch{}finally{o.hide()}})}saveSettings(){return W(this,null,function*(){let o=p.create(p,this.formGroup.value);o.id?yield this.settingService.update(o):yield this.settingService.create(o)})}static \u0275fac=function(n){return new(n||e)(d(S),d(C),d(V))};static \u0275cmp=c({type:e,selectors:[["app-settings"]],standalone:!1,features:[N([S,C])],decls:72,vars:3,consts:[[1,"container","py-5",3,"formGroup"],[1,"mb-4","fw-semibold"],[1,"d-flex","justify-content-end","mb-2"],["role","button",1,"btn-link","text-muted","small","text-decoration-none"],[1,"bi","bi-csv","me-1"],[1,"mb-5"],[1,"tsway-card"],[1,"tsway-card-header"],[1,"mb-0"],[1,"tsway-card-body","pt-3","pe-3","ps-3"],[1,"mb-3","row"],[1,"col-sm-4","col-form-label"],[1,"col-sm-8"],["formControlName","otpRetryLimit","type","number","placeholder","Enter max retry limit",1,"form-control"],[1,"tsway-card","tsway-card"],["formControlName","bankCode","placeholder","Enter default bank name or code",1,"form-control"],["disabled",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","branchCode","placeholder","Enter default bank name or code",1,"form-control"],[1,"text-muted","mb-3"],["formControlName","smtpServer","type","text","placeholder","smtp.example.com",1,"form-control"],["formControlName","smtpPort","type","number","placeholder","e.g. 587",1,"form-control"],["formControlName","smtpUser","type","text","placeholder","Enter username",1,"form-control"],["formControlName","smtpPass","type","password","placeholder","Enter password",1,"form-control"],[1,"text-end"],[1,"btn","btn-primary","btn-lg","px-5",3,"click"],[3,"value"]],template:function(n,a){n&1&&(i(0,"form",0)(1,"div")(2,"h2",1),r(3,"Settings"),t(),i(4,"div",2)(5,"a",3),m(6,"i",4),r(7," Upload Branch "),t()()(),i(8,"section",5)(9,"div",6)(10,"div",7)(11,"h6",8),r(12,"OTP Settings"),t()(),i(13,"div",9)(14,"div",10)(15,"label",11),r(16,"Max Retry Limit for OTPs"),t(),i(17,"div",12),m(18,"input",13),t()()()()(),i(19,"section",5)(20,"div",14)(21,"div",7)(22,"h6",8),r(23,"Bank Settings"),t()(),i(24,"div",9)(25,"div",10)(26,"label",11),r(27,"Default Bank"),t(),i(28,"div",12)(29,"select",15)(30,"option",16),r(31,"Select One"),t(),f(32,qe,2,2,"option",17),t()()(),i(33,"div",10)(34,"label",11),r(35,"Default Branch"),t(),i(36,"div",12)(37,"select",18)(38,"option",16),r(39,"Select One"),t(),f(40,ze,2,2,"option",17),t()()()()()(),i(41,"section",5)(42,"div",6)(43,"div",7)(44,"h6",8),r(45,"System Settings"),t()(),i(46,"div",9)(47,"h6",19),r(48,"SMTP Settings"),t(),i(49,"div",10)(50,"label",11),r(51,"SMTP Server"),t(),i(52,"div",12),m(53,"input",20),t()(),i(54,"div",10)(55,"label",11),r(56,"SMTP Port"),t(),i(57,"div",12),m(58,"input",21),t()(),i(59,"div",10)(60,"label",11),r(61,"SMTP Username"),t(),i(62,"div",12),m(63,"input",22),t()(),i(64,"div",10)(65,"label",11),r(66,"SMTP Password"),t(),i(67,"div",12),m(68,"input",23),t()()()()(),i(69,"div",24)(70,"button",25),u("click",function(){return a.saveSettings()}),r(71,"Save Settings"),t()()()),n&2&&(l("formGroup",a.formGroup),s(32),l("ngForOf",a.bankOptions),s(8),l("ngForOf",a.branchOptions))},dependencies:[E,B,ue,ve,R,ce,fe,j,L,G,U],encapsulation:2})};var Ke=[{path:"",component:Y,children:[{path:"",loadChildren:()=>import("./chunk-P7FCD7YM.js").then(e=>e.DashboardModule)},{path:"customers",loadChildren:()=>import("./chunk-2DAOMJ6Q.js").then(e=>e.HomeModule)},{path:"transactions",loadChildren:()=>import("./chunk-SYINHZQ7.js").then(e=>e.TransactionLogModule)},{path:"otplogs",loadChildren:()=>import("./chunk-LPN5ANVN.js").then(e=>e.OtpCheckModule)},{path:"settings",component:J}]}],Q=class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=_({type:e});static \u0275inj=k({imports:[Z.forChild(Ke),Z]})};var xe=class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=_({type:e});static \u0275inj=k({imports:[Q,Se,oe,ge]})};export{xe as AdminModule};
