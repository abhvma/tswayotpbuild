import{d as S}from"./chunk-ZNP5E2IQ.js";import"./chunk-KH7BRNI5.js";import{a as ye,b as ve}from"./chunk-DRM7ZKYO.js";import{b as ke}from"./chunk-6WKN5HJ4.js";import"./chunk-HVPVQXOI.js";import{c as ge}from"./chunk-QLKXYMQI.js";import{a as me,b as V,c as pe,d as ce,e as le,f as se,g as de,h as ue,i as fe,j as he,m as Ce,n as be}from"./chunk-PV2HAKDE.js";import{b as h}from"./chunk-44S3GGHA.js";import{A as P,B as M,Ba as B,Ca as A,D as H,Da as J,E as y,N as q,O as a,Pa as F,Qa as W,Ra as X,S as T,V as f,W as L,Y as O,Z as K,_ as s,bb as Y,ca as p,cb as Z,fb as ee,ga as n,gb as te,ha as i,ia as c,ja as Q,ka as z,la as j,ma as v,na as I,ob as re,pb as oe,qb as ie,rb as ne,t as R,u as G,ua as U,va as m,vb as ae,w as $,wa as l}from"./chunk-24GG73RQ.js";import"./chunk-FK6H3RFT.js";import{f as N}from"./chunk-WR2VUDLS.js";var C=(o=>(o[o.MobileBank=1]="MobileBank",o[o.InternetBank=2]="InternetBank",o[o.Other=3]="Other",o))(C||{}),b=(e=>(e[e.Ok=1]="Ok",e[e.Error=0]="Error",e))(b||{}),Se={traceDate:"trace_date",traceNumber:"trace_no",customerId:"custom_id",traceType:"trace_type",bankCode:"bank_code",otpNumber:"otpnum",status:"ok"},u=class extends Z{traceDate=new h;traceNumber=0;customerId="";traceType=1;bankCode="";otpNumber=0;status=1;customer;constructor(){super(),this._mapper=new oe(Se)}getPrimaryKeyName(){return"traceNumber"}setTraceDate(t){this.traceDate=new h(t)}getSoftDelete(){}};N([ne("trace_no")],u.prototype,"traceNumber",2),u=N([ie("otpchk")],u);var k=class r extends re{constructor(t){super(t,u)}getName(){return"otpchk"}static \u0275fac=function(e){return new(e||r)($(ae))};static \u0275prov=R({token:r,factory:r.\u0275fac})};var x=class r{transform(t){return C[t]||"Unknown"}static \u0275fac=function(e){return new(e||r)};static \u0275pipe=O({name:"otpTraceType",type:r,pure:!0,standalone:!1})};var _=class r{transform(t){let e={1:"success",0:"danger"},o=b[t];return`<span class="badge bg-${e[t]||"secondary"}">${o}</span>`}static \u0275fac=function(e){return new(e||r)};static \u0275pipe=O({name:"otpStatusBadge",type:r,pure:!0,standalone:!1})};function De(r,t){if(r&1&&(n(0,"th",3),m(1),i()),r&2){let e=t.$implicit;p("width",e.width),a(),l(e.label)}}function Ee(r,t){if(r&1&&(n(0,"tr")(1,"td"),m(2),i(),n(3,"td"),m(4),B(5,"otpTraceType"),i(),n(6,"td"),m(7),i(),n(8,"td"),m(9),i(),n(10,"td"),m(11),i(),n(12,"td"),c(13,"span",4),B(14,"otpStatusBadge"),i(),n(15,"td"),m(16),i()()),r&2){let e=t.$implicit;a(2),l(e.traceNumber),a(2),l(A(5,7,e.traceType)),a(3),l(e.customerId),a(2),l(e.customer==null?null:e.customer.customerName),a(2),l(e.otpNumber),a(2),p("innerHTML",A(14,9,e.status),q),a(3),l(e.traceDate)}}var D=class r{models=[];editClick=new y;deleteClick=new y;columns=[{label:"Trace Number",width:"12%"},{label:"Trace Type",width:"10%"},{label:"Customer ID",width:"10%"},{label:"Customer Name",width:"14%"},{label:"OPT Number",width:"12%"},{label:"Status",width:"8%"},{label:"Trace Date",width:"10%"}];static \u0275fac=function(e){return new(e||r)};static \u0275cmp=f({type:r,selectors:[["app-otpcheck-table"]],inputs:{models:"models"},outputs:{editClick:"editClick",deleteClick:"deleteClick"},standalone:!1,decls:6,vars:2,consts:[[1,"tsway-datatable","striped"],[3,"width",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"width"],[3,"innerHTML"]],template:function(e,o){e&1&&(n(0,"table",0)(1,"thead")(2,"tr"),s(3,De,2,2,"th",1),i()(),n(4,"tbody"),s(5,Ee,17,11,"tr",2),i()()),e&2&&(a(3),p("ngForOf",o.columns),a(2),p("ngForOf",o.models))},dependencies:[F,x,_],encapsulation:2})};function Ne(r,t){if(r&1&&(n(0,"option",17),m(1),i()),r&2){let e=t.$implicit;p("value",e.key),a(),l(e.value)}}function Pe(r,t){if(r&1&&(n(0,"option",17),m(1),i()),r&2){let e=t.$implicit;p("value",e.key),a(),l(e.value)}}var E=class r{constructor(t){this.fb=t;this.filterForm=this.fb.group({traceDateFrom:["",V.required],traceDateTo:["",V.required],traceType:[""],customerId:[""],bankCode:[""],status:[""]})}filterChange=new y;filterForm;subscriptions=[];EKeyStatus=b;ETraceType=C;statusOptions=Object.entries(b).filter(([t,e])=>typeof e=="number").map(([t,e])=>({key:e,value:t}));traceTypeOptions=Object.entries(C).filter(([t,e])=>typeof e=="number").map(([t,e])=>({key:e,value:t}));emitFilter(){this.filterChange.emit(this.filterForm.value)}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}static \u0275fac=function(e){return new(e||r)(T(Ce))};static \u0275cmp=f({type:r,selectors:[["app-otpcheck-filterbar"]],outputs:{filterChange:"filterChange"},standalone:!1,decls:32,vars:4,consts:[[1,"filterbar","mb-3"],[1,"row","g-3","align-items-end","w-100",3,"formGroup"],[1,"col"],["for","customerId",1,"form-label","small","mb-1"],["type","text","id","customerId","formControlName","customerId",1,"form-control"],["for","traceType",1,"form-label","small","mb-1"],["id","traceType","formControlName","traceType",1,"form-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","status",1,"form-label","small","mb-1"],["id","status","formControlName","status",1,"form-select"],["for","traceDateFrom",1,"form-label","small","mb-1"],["type","date","id","traceDateFrom","formControlName","traceDateFrom",1,"form-control"],["for","traceDateTo",1,"form-label","small","mb-1"],["type","date","id","traceDateTo","formControlName","traceDateTo",1,"form-control"],["type","button",1,"btn","btn-primary","w-100",3,"click","disabled"],[1,"bi","bi-search"],[3,"value"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"form",1)(2,"div",2)(3,"label",3),m(4,"Customer ID"),i(),c(5,"input",4),i(),n(6,"div",2)(7,"label",5),m(8,"Trace Type"),i(),n(9,"select",6)(10,"option",7),m(11,"All"),i(),s(12,Ne,2,2,"option",8),i()(),n(13,"div",2)(14,"label",9),m(15,"Status"),i(),n(16,"select",10)(17,"option",7),m(18,"All"),i(),s(19,Pe,2,2,"option",8),i()(),n(20,"div",2)(21,"label",11),m(22,"Trace From*"),i(),c(23,"input",12),i(),n(24,"div",2)(25,"label",13),m(26,"Trace To*"),i(),c(27,"input",14),i(),n(28,"div",2)(29,"button",15),v("click",function(){return o.emitFilter()}),c(30,"i",16),m(31," Search "),i()()()()),e&2&&(a(),p("formGroup",o.filterForm),a(11),p("ngForOf",o.traceTypeOptions),a(7),p("ngForOf",o.statusOptions),a(10),p("disabled",o.filterForm.invalid))},dependencies:[F,le,fe,he,me,ue,pe,ce,se,de],encapsulation:2})};function je(r,t){if(r&1){let e=j();n(0,"div",7)(1,"a",8),v("click",function(){P(e);let d=I();return M(d.downloadTable())}),c(2,"i",9),m(3," Download PDF "),i()()}}function Be(r,t){if(r&1&&(Q(0),c(1,"app-otpcheck-table",10),z()),r&2){let e=I();a(),p("models",e.models)}}function Ae(r,t){r&1&&(n(0,"div")(1,"p",3),m(2,"Search for OTP logs"),i()())}function Ve(r,t){r&1&&(n(0,"div")(1,"p",3),m(2,"No OTP log found for the given conditions."),i()())}function Re(r,t){if(r&1&&(n(0,"div",11)(1,"div"),c(2,"i",12),s(3,Ae,3,0,"div",13)(4,Ve,3,0,"div",13),i()()),r&2){let e=I();a(3),p("ngIf",!e.hasSearched),a(),p("ngIf",e.hasSearched)}}var w=class r extends ke{hasSearched=!1;customerService;constructor(t){super(t),this.modelService=t.get(k),this.customerService=t.get(S)}loadCustomers(){this.models.length!==0&&this.customerService.get().then(t=>{let e={};t.forEach(o=>{e[o.customerId]=o}),this.models.forEach(o=>{o.customer=e[o.customerId]})})}getFilterParams(){let t=[];return this.modelFilters.customerId&&t.push({customerId:this.modelFilters.customerId}),this.modelFilters.traceDateTo&&t.push({traceDate:te(new h(this.modelFilters.traceDateTo))}),this.modelFilters.traceDateFrom&&t.push({traceDate:ee(new h(this.modelFilters.traceDateFrom))}),this.modelFilters.traceType&&t.push({traceType:this.modelFilters.traceType}),this.modelFilters.status&&t.push({status:this.modelFilters.status}),t}loadModels(){return super.loadModels().then(()=>(this.hasSearched=!0,this.loadCustomers(),this.models))}openDialog(t){throw new Error("Method not implemented.")}applyFilters(){this.loadModels().then()}downloadTable(){let t=new ye;t.setFontSize(12);let e=this.models.map(o=>({traceDate:o.traceDate.toLocaleString(),traceNumber:o.traceNumber,customerId:o.customerId,traceType:o.traceType,bankCode:o.bankCode,otpNumber:o.otpNumber,status:o.status}));ve(t,{head:[["Trace Date","Trace Number","Customer ID","Trace Type","Bank Code","OTP Number","Status"]],body:e.map(o=>[o.traceDate,o.traceNumber,o.customerId,o.traceType,o.bankCode,o.otpNumber,o.status])}),t.save(`otpcheck-log${new Date().toDateString()}.pdf`)}static \u0275fac=function(e){return new(e||r)(T(H))};static \u0275cmp=f({type:r,selectors:[["app-otpcheck"]],standalone:!1,features:[K],decls:9,vars:3,consts:[["noData",""],[1,"container-fluid","py-4","d-flex","flex-column","vh-100"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"mb-0"],[3,"filterChange"],["class","d-flex justify-content-end mb-2",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-end","mb-2"],["role","button",1,"btn-link","text-muted","small","text-decoration-none",3,"click"],[1,"bi","bi-file-earmark-pdf","me-1"],[3,"models"],[1,"d-flex","justify-content-center","align-items-center","h-100","text-muted","text-center","px-4"],[1,"bi","bi-search","display-6","d-block","mb-2"],[4,"ngIf"]],template:function(e,o){if(e&1){let d=j();n(0,"div",1)(1,"div",2)(2,"h2",3),m(3,"OTP Check Logs"),i()(),n(4,"app-otpcheck-filterbar",4),v("filterChange",function(Fe){return P(d),M(o.onFilterChange(Fe))}),i(),s(5,je,4,0,"div",5)(6,Be,2,1,"ng-container",6)(7,Re,5,2,"ng-template",null,0,J),i()}if(e&2){let d=U(8);a(5),p("ngIf",o.models.length>0),a(),p("ngIf",o.models.length>0)("ngIfElse",d)}},dependencies:[W,D,E],encapsulation:2})};var Ge=[{path:"",component:w}],Ie=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=L({type:r});static \u0275inj=G({providers:[k,S],imports:[ge,X,Y.forChild(Ge),be]})};export{Ie as OtpCheckModule};
