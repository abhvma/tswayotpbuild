import{c as I}from"./chunk-MVWK5YE4.js";import{c as nt}from"./chunk-DICJOYZV.js";import"./chunk-KH7BRNI5.js";import{b as T}from"./chunk-44S3GGHA.js";import{a as rt}from"./chunk-HVPVQXOI.js";import{h as l,m as w}from"./chunk-MXDAFLWT.js";import{$ as j,Ba as Q,D as E,Da as Y,Fa as J,Ha as tt,I as g,J as G,K as q,S as o,Va as et,W as d,Wa as it,Z as u,_ as O,a as _,aa as V,b as P,c as A,ca as H,e as x,f as N,ga as h,gb as at,ia as $,jb as S,ka as s,la as r,ma as c,ra as Z,s as U,u as B,va as W,wa as K,xa as X,y,z as k,za as m}from"./chunk-CBY2OJCD.js";import{a as R,h as v}from"./chunk-ENRHZQ2S.js";var L=class a{transform(i,t){if(i==null||i==="")return"";let e=Number(i);if(isNaN(e))return i.toString();let n=t?.locale??"np";return t?.shorten??!1?this.shortenNumber(e):n==="np"?this.formatIndian(e):this.formatWestern(e)}formatWestern(i){return new Intl.NumberFormat("en-US").format(i)}formatIndian(i){let t=i.toString().split("."),e=t[0],n=t[1]?`.${t[1]}`:"",p=e.slice(-3),b=e.slice(0,-3),C=b.replace(/\B(?=(\d{2})+(?!\d))/g,",");return(b?C+",":"")+p+n}shortenNumber(i){let t=Math.abs(i),e;return t>=1e9?e=(i/1e9).toFixed(2)+"B":t>=1e6?e=(i/1e6).toFixed(2)+"M":t>=1e3?e=(i/1e3).toFixed(2)+"K":e=i.toString(),e.replace(/\.00([KMB])$/,"$1")}static \u0275fac=function(t){return new(t||a)};static \u0275pipe=V({name:"numberLocale",type:a,pure:!0})};var ut=["card"],mt=()=>({shorten:!0}),D=class a{constructor(i){this.http=i}title="";value="";changeText="";iconClass="";qb;container;ngAfterViewInit(){let i=new rt(this.container.nativeElement),[t,e]=this.qb.buildParameterized();i.show(),this.http.post(w.api,{params:e,sql:t}).then(n=>{n.length>0?this.value=""+(n[0].count||"NA"):this.value="NA"}).finally(()=>i.hide())}static \u0275fac=function(t){return new(t||a)(d(S))};static \u0275cmp=u({type:a,selectors:[["app-stat-card"]],viewQuery:function(t,e){if(t&1&&W(ut,5),t&2){let n;K(n=X())&&(e.container=n.first)}},inputs:{title:"title",value:"value",changeText:"changeText",iconClass:"iconClass",qb:"qb"},standalone:!1,decls:11,vars:8,consts:[["card",""],[1,"stat-card","card","border-0","p-3"],[1,"d-flex","align-items-center"],[1,"icon-wrapper","d-flex","align-items-center","justify-content-center","flex-shrink-0","me-3"],[1,"d-flex","flex-column"],[1,"stat-title","text-muted"],[1,"stat-value","fw-bold"]],template:function(t,e){t&1&&(s(0,"div",1,0)(2,"div",2)(3,"div",3),c(4,"i"),r(),s(5,"div",4)(6,"span",5),m(7),r(),s(8,"span",6),m(9),J(10,"numberLocale"),r()()()()),t&2&&(o(4),$("bi "+e.iconClass),o(3),Q(" ",e.title," "),o(2),Q(" ",tt(10,4,e.value,Y(7,mt))," "))},dependencies:[L],styles:[".stat-card[_ngcontent-%COMP%]{background-color:#f1f1f1}.stat-card[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{width:72px;height:72px;border-radius:30px;background-color:#c7e6f9}.stat-card[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:44px;color:var(--bs-primary)}.stat-card[_ngcontent-%COMP%]   .stat-title[_ngcontent-%COMP%]{font-size:16px}.stat-card[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:32px}.stat-card[_ngcontent-%COMP%]   .stat-change[_ngcontent-%COMP%]{font-size:14px}"]})};var F=class{constructor(){this.subject=new x(1),this.subscriptions=new _}doFilter(i){this.subject.next(i)}dispose(){this.subscriptions.unsubscribe()}notEmpty(i,t){this.subscriptions.add(this.subject.subscribe(e=>{if(e[i]){let n=e[i].currentValue;n!=null&&t(n)}}))}has(i,t){this.subscriptions.add(this.subject.subscribe(e=>{if(e[i]){let n=e[i].currentValue;t(n)}}))}notFirst(i,t){this.subscriptions.add(this.subject.subscribe(e=>{if(e[i]&&!e[i].isFirstChange()){let n=e[i].currentValue;t(n)}}))}notFirstAndEmpty(i,t){this.subscriptions.add(this.subject.subscribe(e=>{if(e[i]&&!e[i].isFirstChange()){let n=e[i].currentValue;n!=null&&t(n)}}))}},ot=new k("NGX_ECHARTS_CONFIG"),ct=(()=>{class a{constructor(t,e,n){this.el=e,this.ngZone=n,this.options=null,this.theme=null,this.initOpts=null,this.merge=null,this.autoResize=!0,this.loading=!1,this.loadingType="default",this.loadingOpts=null,this.chartInit=new g,this.optionsError=new g,this.chartClick=this.createLazyEvent("click"),this.chartDblClick=this.createLazyEvent("dblclick"),this.chartMouseDown=this.createLazyEvent("mousedown"),this.chartMouseMove=this.createLazyEvent("mousemove"),this.chartMouseUp=this.createLazyEvent("mouseup"),this.chartMouseOver=this.createLazyEvent("mouseover"),this.chartMouseOut=this.createLazyEvent("mouseout"),this.chartGlobalOut=this.createLazyEvent("globalout"),this.chartContextMenu=this.createLazyEvent("contextmenu"),this.chartHighlight=this.createLazyEvent("highlight"),this.chartDownplay=this.createLazyEvent("downplay"),this.chartSelectChanged=this.createLazyEvent("selectchanged"),this.chartLegendSelectChanged=this.createLazyEvent("legendselectchanged"),this.chartLegendSelected=this.createLazyEvent("legendselected"),this.chartLegendUnselected=this.createLazyEvent("legendunselected"),this.chartLegendLegendSelectAll=this.createLazyEvent("legendselectall"),this.chartLegendLegendInverseSelect=this.createLazyEvent("legendinverseselect"),this.chartLegendScroll=this.createLazyEvent("legendscroll"),this.chartDataZoom=this.createLazyEvent("datazoom"),this.chartDataRangeSelected=this.createLazyEvent("datarangeselected"),this.chartGraphRoam=this.createLazyEvent("graphroam"),this.chartGeoRoam=this.createLazyEvent("georoam"),this.chartTreeRoam=this.createLazyEvent("treeroam"),this.chartTimelineChanged=this.createLazyEvent("timelinechanged"),this.chartTimelinePlayChanged=this.createLazyEvent("timelineplaychanged"),this.chartRestore=this.createLazyEvent("restore"),this.chartDataViewChanged=this.createLazyEvent("dataviewchanged"),this.chartMagicTypeChanged=this.createLazyEvent("magictypechanged"),this.chartGeoSelectChanged=this.createLazyEvent("geoselectchanged"),this.chartGeoSelected=this.createLazyEvent("geoselected"),this.chartGeoUnselected=this.createLazyEvent("geounselected"),this.chartAxisAreaSelected=this.createLazyEvent("axisareaselected"),this.chartBrush=this.createLazyEvent("brush"),this.chartBrushEnd=this.createLazyEvent("brushend"),this.chartBrushSelected=this.createLazyEvent("brushselected"),this.chartGlobalCursorTaken=this.createLazyEvent("globalcursortaken"),this.chartRendered=this.createLazyEvent("rendered"),this.chartFinished=this.createLazyEvent("finished"),this.animationFrameID=null,this.chart$=new x(1),this.resize$=new A,this.changeFilter=new F,this.resizeObFired=!1,this.echarts=t.echarts,this.theme=t.theme||null}ngOnChanges(t){this.changeFilter.doFilter(t)}ngOnInit(){if(!window.ResizeObserver)throw new Error("please install a polyfill for ResizeObserver");this.resizeSub=this.resize$.pipe(B(100,N,{leading:!1,trailing:!0})).subscribe(()=>this.resize()),this.autoResize&&(this.resizeOb=this.ngZone.runOutsideAngular(()=>new window.ResizeObserver(t=>{for(let e of t)e.target===this.el.nativeElement&&(this.resizeObFired?this.animationFrameID=window.requestAnimationFrame(()=>{this.resize$.next()}):this.resizeObFired=!0)})),this.resizeOb.observe(this.el.nativeElement)),this.changeFilter.notFirstAndEmpty("options",t=>this.onOptionsChange(t)),this.changeFilter.notFirstAndEmpty("merge",t=>this.setOption(t)),this.changeFilter.has("loading",t=>this.toggleLoading(!!t)),this.changeFilter.notFirst("theme",()=>this.refreshChart())}ngOnDestroy(){window.clearTimeout(this.initChartTimer),this.resizeSub&&this.resizeSub.unsubscribe(),this.animationFrameID&&window.cancelAnimationFrame(this.animationFrameID),this.resizeOb&&this.resizeOb.unobserve(this.el.nativeElement),this.loadingSub&&this.loadingSub.unsubscribe(),this.changeFilter.dispose(),this.dispose()}ngAfterViewInit(){this.initChartTimer=window.setTimeout(()=>this.initChart())}dispose(){this.chart&&(this.chart.isDisposed()||this.chart.dispose(),this.chart=null)}resize(){this.chart&&this.chart.resize()}toggleLoading(t){this.chart?t?this.chart.showLoading(this.loadingType,this.loadingOpts):this.chart.hideLoading():this.loadingSub=this.chart$.subscribe(e=>t?e.showLoading(this.loadingType,this.loadingOpts):e.hideLoading())}setOption(t,e){if(this.chart)try{this.chart.setOption(t,e)}catch(n){console.error(n),this.optionsError.emit(n)}}refreshChart(){return v(this,null,function*(){this.dispose(),yield this.initChart()})}createChart(){let t=this.el.nativeElement;if(window&&window.getComputedStyle){let e=window.getComputedStyle(t,null).getPropertyValue("height");(!e||e==="0px")&&(!t.style.height||t.style.height==="0px")&&(t.style.height="400px")}return this.ngZone.runOutsideAngular(()=>(typeof this.echarts=="function"?this.echarts:()=>Promise.resolve(this.echarts))().then(({init:n})=>n(t,this.theme,this.initOpts)))}initChart(){return v(this,null,function*(){yield this.onOptionsChange(this.options),this.merge&&this.chart&&this.setOption(this.merge)})}onOptionsChange(t){return v(this,null,function*(){t&&(this.chart?this.setOption(this.options,!0):(this.chart=yield this.createChart(),this.chart$.next(this.chart),this.chartInit.emit(this.chart),this.setOption(this.options,!0)))})}createLazyEvent(t){return this.chartInit.pipe(U(e=>new P(n=>(e.on(t,p=>this.ngZone.run(()=>n.next(p))),()=>{this.chart&&(this.chart.isDisposed()||e.off(t))}))))}static{this.\u0275fac=function(e){return new(e||a)(d(ot),d(q),d(G))}}static{this.\u0275dir=j({type:a,selectors:[["echarts"],["","echarts",""]],inputs:{options:"options",theme:"theme",initOpts:"initOpts",merge:"merge",autoResize:"autoResize",loading:"loading",loadingType:"loadingType",loadingOpts:"loadingOpts"},outputs:{chartInit:"chartInit",optionsError:"optionsError",chartClick:"chartClick",chartDblClick:"chartDblClick",chartMouseDown:"chartMouseDown",chartMouseMove:"chartMouseMove",chartMouseUp:"chartMouseUp",chartMouseOver:"chartMouseOver",chartMouseOut:"chartMouseOut",chartGlobalOut:"chartGlobalOut",chartContextMenu:"chartContextMenu",chartHighlight:"chartHighlight",chartDownplay:"chartDownplay",chartSelectChanged:"chartSelectChanged",chartLegendSelectChanged:"chartLegendSelectChanged",chartLegendSelected:"chartLegendSelected",chartLegendUnselected:"chartLegendUnselected",chartLegendLegendSelectAll:"chartLegendLegendSelectAll",chartLegendLegendInverseSelect:"chartLegendLegendInverseSelect",chartLegendScroll:"chartLegendScroll",chartDataZoom:"chartDataZoom",chartDataRangeSelected:"chartDataRangeSelected",chartGraphRoam:"chartGraphRoam",chartGeoRoam:"chartGeoRoam",chartTreeRoam:"chartTreeRoam",chartTimelineChanged:"chartTimelineChanged",chartTimelinePlayChanged:"chartTimelinePlayChanged",chartRestore:"chartRestore",chartDataViewChanged:"chartDataViewChanged",chartMagicTypeChanged:"chartMagicTypeChanged",chartGeoSelectChanged:"chartGeoSelectChanged",chartGeoSelected:"chartGeoSelected",chartGeoUnselected:"chartGeoUnselected",chartAxisAreaSelected:"chartAxisAreaSelected",chartBrush:"chartBrush",chartBrushEnd:"chartBrushEnd",chartBrushSelected:"chartBrushSelected",chartGlobalCursorTaken:"chartGlobalCursorTaken",chartRendered:"chartRendered",chartFinished:"chartFinished"},exportAs:["echarts"],features:[E]})}}return a})(),ft=a=>({provide:ot,useValue:a}),ht=(()=>{class a{static forRoot(t){return{ngModule:a,providers:[ft(t)]}}static forChild(){return{ngModule:a}}static{this.\u0275fac=function(e){return new(e||a)}}static{this.\u0275mod=O({type:a})}static{this.\u0275inj=y({})}}return a})();var M=class a{dateChange=new g;data=[];lineChartOptions={title:{text:"Transactions",left:"left",padding:[0,0,0,0]},tooltip:{trigger:"axis"},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]},yAxis:{type:"value"},series:[{name:"Total Transaction",type:"line",data:[120,132,101,134,90,230,210],smooth:!0,lineStyle:{width:3},areaStyle:{opacity:.2}}]};ngOnChanges(i){i.data.previousValue!==i.data.currentValue&&this.generateLineChartOptions()}generateLineChartOptions(){this.lineChartOptions=R({},this.lineChartOptions),this.lineChartOptions.xAxis.data=this.data.map(i=>i[0].toString()),this.lineChartOptions.series[0].data=this.data.map(i=>i[1])}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=u({type:a,selectors:[["app-transaction-chart"]],inputs:{data:"data"},outputs:{dateChange:"dateChange"},standalone:!1,features:[E],decls:1,vars:1,consts:[["echarts","",1,"chart",2,"width","100%","height","500px",3,"options"]],template:function(t,e){t&1&&c(0,"div",0),t&2&&h("options",e.lineChartOptions)},dependencies:[ct],encapsulation:2})};function vt(a,i){if(a&1&&(s(0,"div",16),c(1,"app-transaction-chart",17),r()),a&2){let t=Z();o(),h("data",t.chartData)}}var z=class a{constructor(i){this.http=i}totalUserQb;OtpCardUserQb;OtpAppUserQb;OtherUserQb;totalTransactionsQb;totalMobileTransactionQb;internetTransactionQb;totalOtherTransactionQb;chartData=[];getCardData(){let i=new nt;this.totalUserQb=new l(i),this.totalUserQb.raw("SELECT count(*) as count from cifmst"),this.OtpAppUserQb=new l(i),this.OtpAppUserQb.raw("SELECT count(*) as count from cifmst where otptype=?",[1]),this.OtpCardUserQb=new l(i),this.OtpCardUserQb.raw("SELECT count(*) as count from cifmst where otptype=?",[2]),this.OtherUserQb=new l(i),this.OtherUserQb.raw("SELECT count(*) as count from cifmst where otptype=?",[3]);let t=new I;this.totalTransactionsQb=new l(t),this.totalTransactionsQb.raw("SELECT count(*) as count from otpchk where status=?",[1]),this.internetTransactionQb=new l(t),this.internetTransactionQb.raw("SELECT count(*) as count from otpchk where status=? and trace_type=?",[1,2]),this.totalMobileTransactionQb=new l(t),this.totalMobileTransactionQb.raw("SELECT count(*) as count from otpchk where status=? and trace_type=?",[1,1]),this.totalOtherTransactionQb=new l(t),this.totalOtherTransactionQb.raw("SELECT count(*) as count from otpchk where status=? and trace_type=?",[1,3])}ngOnInit(){this.getCardData(),this.getChartData(new T(2025,6,1),new T(2025,6,31))}getChartData(i,t){let e=new l(new I);e.raw(`
        SELECT DATE(trace_date) as day
        COUNT(*) as count
        FROM otpchk
        WHERE trace_date BETWEEN ? and ?
        GROUP BY DATE(trace_date)
        ORDER BY day
      `,[i,t]);let[n,p]=e.buildParameterized();this.http.post(w.api,{sql:n,params:p}).then(b=>{this.chartData=b.map(C=>[new T(C[0]),C[1]])})}static \u0275fac=function(t){return new(t||a)(d(S))};static \u0275cmp=u({type:a,selectors:[["app-dashboard"]],standalone:!1,decls:25,vars:9,consts:[[1,"container-fluid","vh-100"],[1,"py-4","d-flex","flex-column"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"mb-0"],[1,"text-muted","mb-4"],[1,"row","g-3"],[1,"col-md-3"],["title","Total Users","value","0","iconClass","bi-people-fill",3,"qb"],["title","OTP Card Users","value","0","iconClass","bi-credit-card-2-front-fill",3,"qb"],["title","OTP App Users","value","0","iconClass","bi-phone-vibrate-fill",3,"qb"],["title","Other Users","value","0","iconClass","bi-person-lines-fill",3,"qb"],["title","Total Transactions","value","0","iconClass","bi-arrow-repeat",3,"qb"],["title","OTP Transactions","value","0","iconClass","bi-shield-lock-fill",3,"qb"],["title","Mobile Transactions","value","0","iconClass","bi-phone-flip",3,"qb"],["title","Other Transactions","value","0","iconClass","bi-box-arrow-left",3,"qb"],["class","py-4",4,"ngIf"],[1,"py-4"],[3,"data"]],template:function(t,e){t&1&&(s(0,"section",0)(1,"div",1)(2,"div",2)(3,"h2",3),m(4,"Dashboard"),r()(),s(5,"h5",4),m(6,"Insights"),r(),s(7,"div",5)(8,"div",6),c(9,"app-stat-card",7),r(),s(10,"div",6),c(11,"app-stat-card",8),r(),s(12,"div",6),c(13,"app-stat-card",9),r(),s(14,"div",6),c(15,"app-stat-card",10),r(),s(16,"div",6),c(17,"app-stat-card",11),r(),s(18,"div",6),c(19,"app-stat-card",12),r(),s(20,"div",6),c(21,"app-stat-card",13),r(),s(22,"div",6),c(23,"app-stat-card",14),r()()(),H(24,vt,2,1,"div",15),r()),t&2&&(o(9),h("qb",e.totalUserQb),o(2),h("qb",e.OtpCardUserQb),o(2),h("qb",e.OtpAppUserQb),o(2),h("qb",e.OtherUserQb),o(2),h("qb",e.totalTransactionsQb),o(2),h("qb",e.totalTransactionsQb),o(2),h("qb",e.totalMobileTransactionQb),o(2),h("qb",e.totalOtherTransactionQb),o(),h("ngIf",e.chartData.length>0))},dependencies:[et,D,M],styles:[".stat-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px}.icon[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:50%;display:flex;justify-content:center;align-items:center}.bg-light-blue[_ngcontent-%COMP%]{background-color:#e6f2fe}.bg-light-orange[_ngcontent-%COMP%]{background-color:#fff4e5}.bg-light-purple[_ngcontent-%COMP%]{background-color:#eef3fd}.bg-light-red[_ngcontent-%COMP%]{background-color:#ffecec}"]})};var yt=[{path:"",component:z}],lt=class a{static \u0275fac=function(t){return new(t||a)};static \u0275mod=O({type:a});static \u0275inj=y({imports:[it,at.forChild(yt),ht.forRoot({echarts:()=>import("./chunk-IYA3LGM3.js")})]})};export{lt as DashboardModule};
