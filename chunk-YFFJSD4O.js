import{a as v,b as T,c as ue}from"./chunk-EQMSY7TK.js";import{a as x}from"./chunk-44SR4SAM.js";import"./chunk-TZQHAOMF.js";import{a as Ce,b as be}from"./chunk-TFFLQK24.js";import{b as fe}from"./chunk-BZE4WTPC.js";import{c as he}from"./chunk-EZDIJFPR.js";import{b as A}from"./chunk-COTRNXSH.js";import"./chunk-HVPVQXOI.js";import{A as w,Aa as j,Ab as pe,B as N,Bb as le,Ca as U,Cb as ce,D as $,E as C,Fb as se,Gb as de,M as q,Ma as O,N as a,Na as J,Oa as W,R as k,U as u,V as H,X as y,Y as L,Z as s,_a as X,aa as p,ab as S,cb as Y,db as Z,ea as n,fa as r,ga as c,ha as Q,ia as z,ja as P,ka as b,la as g,lb as ee,sa as K,sb as te,t as B,ta as m,tb as ie,u as R,ua as l,ub as V,vb as oe,w as G,wb as re,xb as ne,yb as ae,za as M,zb as me}from"./chunk-RA2IBNNK.js";import"./chunk-FK6H3RFT.js";import"./chunk-ENRHZQ2S.js";var f=class o extends ee{constructor(t){super(t,ue)}getName(){return"otpchk"}static \u0275fac=function(e){return new(e||o)(G(te))};static \u0275prov=B({token:o,factory:o.\u0275fac})};var F=class o{transform(t){return v[t]||"Unknown"}static \u0275fac=function(e){return new(e||o)};static \u0275pipe=y({name:"otpTraceType",type:o,pure:!0,standalone:!1})};var I=class o{transform(t){let e={1:"success",0:"danger"},i=T[t];return`<span class="badge bg-${e[t]||"secondary"}">${i}</span>`}static \u0275fac=function(e){return new(e||o)};static \u0275pipe=y({name:"otpStatusBadge",type:o,pure:!0,standalone:!1})};function Se(o,t){if(o&1&&(n(0,"th",3),m(1),r()),o&2){let e=t.$implicit;p("width",e.width),a(),l(e.label)}}function xe(o,t){if(o&1&&(n(0,"tr")(1,"td"),m(2),M(3,"otpTraceType"),r(),n(4,"td"),m(5),r(),n(6,"td"),m(7),r(),n(8,"td"),m(9),r(),n(10,"td"),c(11,"span",4),M(12,"otpStatusBadge"),r(),n(13,"td"),m(14),r(),n(15,"td"),m(16),r(),n(17,"td"),m(18),r(),n(19,"td"),m(20),r()()),o&2){let e=t.$implicit;a(2),l(j(3,9,e.traceType)),a(3),l(e.otpNumber),a(2),l(e.otpNumberPrevious),a(2),l(e.otpNumberNext),a(2),p("innerHTML",j(12,11,e.status),q),a(3),l(e.devDate),a(2),l(e.devTime),a(2),l(e.sysTime),a(2),l(e.traceDate.date())}}var _=class o{models=[];editClick=new C;deleteClick=new C;columns=[{label:"Trace Type",width:"6%"},{label:"OTP Number",width:"10%"},{label:"Previous OTP",width:"10%"},{label:"Next OTP",width:"10%"},{label:"Status",width:"6%"},{label:"Dev Date",width:"8%"},{label:"Dev Time",width:"6%"},{label:"System Time",width:"6%"},{label:"Trace Date",width:"10%"}];static \u0275fac=function(e){return new(e||o)};static \u0275cmp=u({type:o,selectors:[["app-otpcheck-table"]],inputs:{models:"models"},outputs:{editClick:"editClick",deleteClick:"deleteClick"},standalone:!1,decls:6,vars:2,consts:[[1,"tsway-datatable","striped"],[3,"width",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"width"],[3,"innerHTML"]],template:function(e,i){e&1&&(n(0,"table",0)(1,"thead")(2,"tr"),s(3,Se,2,2,"th",1),r()(),n(4,"tbody"),s(5,xe,21,13,"tr",2),r()()),e&2&&(a(3),p("ngForOf",i.columns),a(2),p("ngForOf",i.models))},dependencies:[O,F,I],encapsulation:2})};function Ie(o,t){if(o&1&&(n(0,"option",17),m(1),r()),o&2){let e=t.$implicit;p("value",e.key),a(),l(e.value)}}function _e(o,t){if(o&1&&(n(0,"option",17),m(1),r()),o&2){let e=t.$implicit;p("value",e.key),a(),l(e.value)}}var D=class o{constructor(t){this.fb=t;this.filterForm=this.fb.group({traceDateFrom:["",V.required],traceDateTo:["",V.required],traceType:[""],customerId:[""],bankCode:[""],status:[""]})}filterChange=new C;filterForm;subscriptions=[];EKeyStatus=T;ETraceType=v;statusOptions=Object.entries(T).filter(([t,e])=>typeof e=="number").map(([t,e])=>({key:e,value:t}));traceTypeOptions=Object.entries(v).filter(([t,e])=>typeof e=="number").map(([t,e])=>({key:e,value:t}));emitFilter(){this.filterChange.emit(this.filterForm.value)}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}static \u0275fac=function(e){return new(e||o)(k(se))};static \u0275cmp=u({type:o,selectors:[["app-otpcheck-filterbar"]],outputs:{filterChange:"filterChange"},standalone:!1,decls:32,vars:4,consts:[[1,"filterbar","mb-3"],[1,"row","g-3","align-items-end","w-100",3,"formGroup"],[1,"col"],["for","customerId",1,"form-label","small","mb-1"],["type","text","id","customerId","formControlName","customerId",1,"form-control"],["for","traceType",1,"form-label","small","mb-1"],["id","traceType","formControlName","traceType",1,"form-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","status",1,"form-label","small","mb-1"],["id","status","formControlName","status",1,"form-select"],["for","traceDateFrom",1,"form-label","small","mb-1"],["type","date","id","traceDateFrom","formControlName","traceDateFrom",1,"form-control"],["for","traceDateTo",1,"form-label","small","mb-1"],["type","date","id","traceDateTo","formControlName","traceDateTo",1,"form-control"],["type","button",1,"btn","btn-primary","w-100",3,"click","disabled"],[1,"bi","bi-search"],[3,"value"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"form",1)(2,"div",2)(3,"label",3),m(4,"Customer ID"),r(),c(5,"input",4),r(),n(6,"div",2)(7,"label",5),m(8,"Trace Type"),r(),n(9,"select",6)(10,"option",7),m(11,"All"),r(),s(12,Ie,2,2,"option",8),r()(),n(13,"div",2)(14,"label",9),m(15,"Status"),r(),n(16,"select",10)(17,"option",7),m(18,"All"),r(),s(19,_e,2,2,"option",8),r()(),n(20,"div",2)(21,"label",11),m(22,"Trace From*"),r(),c(23,"input",12),r(),n(24,"div",2)(25,"label",13),m(26,"Trace To*"),r(),c(27,"input",14),r(),n(28,"div",2)(29,"button",15),b("click",function(){return i.emitFilter()}),c(30,"i",16),m(31," Search "),r()()()()),e&2&&(a(),p("formGroup",i.filterForm),a(11),p("ngForOf",i.traceTypeOptions),a(7),p("ngForOf",i.statusOptions),a(10),p("disabled",i.filterForm.invalid))},dependencies:[O,ne,le,ce,ie,pe,oe,re,ae,me],encapsulation:2})};function Ee(o,t){if(o&1){let e=P();n(0,"div",7)(1,"a",8),b("click",function(){w(e);let d=g();return N(d.downloadTable())}),c(2,"i",9),m(3," Download PDF "),r()()}}function we(o,t){if(o&1&&(Q(0),c(1,"app-otpcheck-table",10),z()),o&2){let e=g();a(),p("models",e.models)}}function Ne(o,t){o&1&&(n(0,"div")(1,"p",3),m(2,"Search for OTP logs"),r()())}function Pe(o,t){o&1&&(n(0,"div")(1,"p",3),m(2,"No OTP log found for the given conditions."),r()())}function Me(o,t){if(o&1&&(n(0,"div",11)(1,"div"),c(2,"i",12),s(3,Ne,3,0,"div",13)(4,Pe,3,0,"div",13),r()()),o&2){let e=g();a(3),p("ngIf",!e.hasSearched),a(),p("ngIf",e.hasSearched)}}var E=class o extends fe{hasSearched=!1;customerService;constructor(t){super(t),this.modelService=t.get(f),this.customerService=t.get(x)}loadCustomers(){this.models.length!==0&&this.customerService.get().then(t=>{let e={};t.forEach(i=>{e[i.customerId]=i}),this.models.forEach(i=>{i.customer=e[i.customerId]})})}getFilterParams(){let t=[];return this.modelFilters.customerId&&t.push({customerId:S(this.modelFilters.customerId)}),this.modelFilters.traceDateTo&&t.push({traceDate:Z(new A(this.modelFilters.traceDateTo))}),this.modelFilters.traceDateFrom&&t.push({traceDate:Y(new A(this.modelFilters.traceDateFrom))}),this.modelFilters.traceType&&t.push({traceType:S(this.modelFilters.traceType)}),this.modelFilters.status&&t.push({status:S(this.modelFilters.status)}),t}loadModels(){return super.loadModels().then(()=>(this.hasSearched=!0,this.loadCustomers(),this.models))}openDialog(t){throw new Error("Method not implemented.")}applyFilters(){this.loadModels().then()}downloadTable(){let t=new Ce;t.setFontSize(12);let e=this.models.map(i=>({customerId:i.customer.customerId,customerName:i.customer.customerName,traceDate:i.traceDate.toLocaleString(),traceNumber:i.traceNumber,traceType:i.traceType,bankCode:i.bankCode,otpNumber:i.otpNumber,status:i.status,prevOtp:i.otpNumberPrevious,nextOtp:i.otpNumberNext,devDate:i.devDate.date(),devTime:i.devTime.time(),sysTime:i.sysTime.time()}));be(t,{head:[["Customer Id","Customer Name","Trace Type","OTP Number","Prev OTP","Next OTP","Status","Dev Date","Dev Time","System Time","Trace Date"]],body:e.map(i=>[i.customerId,i.customerName,i.traceType,i.otpNumber,i.nextOtp,i.status,i.devDate,i.devTime,i.sysTime,i.traceDate])}),t.save(`otpcheck-log${new Date().toDateString()}.pdf`)}static \u0275fac=function(e){return new(e||o)(k($))};static \u0275cmp=u({type:o,selectors:[["app-otpcheck"]],standalone:!1,features:[L],decls:9,vars:3,consts:[["noData",""],[1,"container-fluid","py-4","d-flex","flex-column","vh-100"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"mb-0"],[3,"filterChange"],["class","d-flex justify-content-end mb-2",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-end","mb-2"],["role","button",1,"btn-link","text-muted","small","text-decoration-none",3,"click"],[1,"bi","bi-file-earmark-pdf","me-1"],[3,"models"],[1,"d-flex","justify-content-center","align-items-center","h-100","text-muted","text-center","px-4"],[1,"bi","bi-search","display-6","d-block","mb-2"],[4,"ngIf"]],template:function(e,i){if(e&1){let d=P();n(0,"div",1)(1,"div",2)(2,"h2",3),m(3,"OTP Check Logs"),r()(),n(4,"app-otpcheck-filterbar",4),b("filterChange",function(ye){return w(d),N(i.onFilterChange(ye))}),r(),s(5,Ee,4,0,"div",5)(6,we,2,1,"ng-container",6)(7,Me,5,2,"ng-template",null,0,U),r()}if(e&2){let d=K(8);a(5),p("ngIf",i.models.length>0),a(),p("ngIf",i.models.length>0)("ngIfElse",d)}},dependencies:[J,_,D],encapsulation:2})};var je=[{path:"",component:E}],ke=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=H({type:o});static \u0275inj=R({providers:[f,x],imports:[he,W,X.forChild(je),de]})};export{ke as OtpCheckModule};
