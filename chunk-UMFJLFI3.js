import{a as _e}from"./chunk-OYIEH6V4.js";import{c as Se}from"./chunk-FKFP3K5F.js";import{a as qe,b as v}from"./chunk-GWJSFVBM.js";import{b as M}from"./chunk-ZRACD77Y.js";import{b as we}from"./chunk-T4OZUYU5.js";import{b as xe}from"./chunk-R35HLCHV.js";import{a as Ie,c as De}from"./chunk-UJRL6OBK.js";import{b as y}from"./chunk-COTRNXSH.js";import{a as Ee}from"./chunk-HVPVQXOI.js";import{Ab as x,B as J,Ba as w,Bb as _,C as W,Ca as D,Cb as ve,Db as k,E as X,Ea as ae,Eb as Ce,F as N,Fb as he,Gb as Ne,Hb as Te,Kb as P,Lb as Fe,N as U,O as m,Oa as me,Pa as le,Qa as se,S as c,V as f,W as Y,Y as q,Z,_ as T,ab as pe,ba as l,bb as ue,cb as S,eb as R,fa as o,fb as B,ga as i,ha as p,ia as ee,ja as te,ka as re,la as b,ma as ie,ob as de,pb as ce,qb as fe,ta as ne,u as $,ua as a,v as L,va as F,vb as be,x as z,xa as oe,xb as ye,yb as d,zb as ge}from"./chunk-RHKCHBCJ.js";import{g as Q,h as I}from"./chunk-ENRHZQ2S.js";var O=class n{constructor(t,e,r){this.fb=t;this.authService=e;this.toast=r;this.userForm=this.fb.group({otpType:["",d.required],count:["",[d.required,d.min(1),d.max(1e4)]],repeatPassword:["",d.required],branchName:[void 0,d.required]})}model;save=new N;cancel=new N;modalTitle="Generate Keys";userForm;eCustomerStatus=qe;eOtpType=v;dialogRef;userNotUnique=!1;ngOnInit(){}onSave(){return I(this,null,function*(){let t=new Ee;try{t.show()}catch{}finally{t.hide()}})}onCancel(){this.dialogRef.close(void 0),this.cancel.emit()}get formControls(){return this.userForm.controls}static \u0275fac=function(e){return new(e||n)(c(P),c(Se),c(Ie))};static \u0275cmp=f({type:n,selectors:[["app-serial-number-create-modal"]],inputs:{model:"model"},outputs:{save:"save",cancel:"cancel"},standalone:!1,features:[oe([M])],decls:12,vars:2,consts:[[1,"modal-content",3,"formGroup"],[1,"tsway-modal-header"],[1,"tsway-modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"tsway-modal-body"],[1,"row"],[1,"tsway-modal-footer","d-flex","flex-row-reverse","justify-content-start"],[1,"btn","btn-primary",3,"click","disabled"],[1,"btn","btn-danger","me-2","text-white",3,"click"]],template:function(e,r){e&1&&(o(0,"form",0)(1,"div",1)(2,"h5",2),a(3,"Add User"),i(),o(4,"button",3),b("click",function(){return r.onCancel()}),i()(),o(5,"div",4),p(6,"div",5),i(),o(7,"div",6)(8,"button",7),b("click",function(){return r.onSave()}),a(9," Save "),i(),o(10,"button",8),b("click",function(){return r.onCancel()}),a(11," Cancel "),i()()()),e&2&&(l("formGroup",r.userForm),m(8),l("disabled",r.userForm.invalid))},dependencies:[_,x,k],styles:["[_nghost-%COMP%]{font-size:.875rem!important}"]})};var E=(u=>(u[u.Created=0]="Created",u[u.Delivered=1]="Delivered",u[u.Assigned=2]="Assigned",u[u.Inactive=3]="Inactive",u[u.Unknown=-1]="Unknown",u))(E||{}),Oe={otpType:"otptype",bankCode:"bank_cd",branchCode:"branch_cd",sequenceNumber:"seqno",otpKey:"otp_key",createdDate:"create_date",status:"status"},C=class extends ue{otpType=2;bankCode="";branchCode="";sequenceNumber=0;otpKey="";createdDate=new y;status=0;constructor(){super(),this._mapper=new ce(Oe)}getSoftDelete(){}getPrimaryKeyName(){return"sequenceNumber"}setCreatedDate(t){this.createdDate=new y(t)}setStatus(t){switch(t){case"0":this.status=0;break;case"1":this.status=1;break;case"2":this.status=2;break;case"3":this.status=3;break;default:this.status=-1}}};C=Q([fe("keymst")],C);var h=class n extends de{constructor(t){super(t,C)}getName(){return"serialkey"}getAssignableKeys(){return this.get([{status:S(1)}]).then(t=>t.sort((e,r)=>e.sequenceNumber-r.sequenceNumber))}getFreshKeys(){return this.get([{status:S(1)}]).then(t=>t.sort((e,r)=>e.sequenceNumber-r.sequenceNumber))}getAssignedKeys(t){return t||(t=[]),this.get([{status:S(2)}]).then(e=>e.sort((r,s)=>r.sequenceNumber-s.sequenceNumber))}static \u0275fac=function(e){return new(e||n)(z(be))};static \u0275prov=$({token:n,factory:n.\u0275fac})};var K=class n{transform(t,...e){let r="",s="";switch(t){case 0:r="bg-info",s="Created";break;case 1:r="bg-success",s="Delivered";break;case 2:r="bg-primary",s="Assigned";break;case 3:r="bg-secondary",s="Inactive";break;case-1:r="badge-warning",s="Unknown";break}return`<span class='badge badge-pill ${r}'>${s}</span>`}static \u0275fac=function(e){return new(e||n)};static \u0275pipe=q({name:"serialNumberStatus",type:n,pure:!0,standalone:!1})};var A=class n{transform(t,...e){let r="",s="";switch(t){case 2:r="bi-credit-card",s="Card";break;case 3:r="bi-safe",s="Token";break;default:r="bi-exclamation",s="Invalid";break}return`<span class=''><i class="bi ${r} me-1"></i></span>`}static \u0275fac=function(e){return new(e||n)};static \u0275pipe=q({name:"serialKeyType",type:n,pure:!0,standalone:!1})};function Ge(n,t){if(n&1&&(o(0,"th",3),a(1),i()),n&2){let e=t.$implicit;l("width",e.width),m(),F(e.label)}}function Ue(n,t){if(n&1&&(o(0,"tr"),p(1,"td",4),w(2,"serialKeyType"),o(3,"td"),a(4),i(),o(5,"td"),a(6),w(7,"keySecret"),i(),o(8,"td"),a(9),i(),p(10,"td",4),w(11,"serialNumberStatus"),i()),n&2){let e=t.$implicit;m(),l("innerHTML",D(2,5,e.otpType),U),m(3),F(e.sequenceNumber),m(2),F(D(7,7,e.otpKey)),m(3),F(e.createdDate.date()),m(),l("innerHTML",D(11,9,e.status),U)}}var V=class n{models=[];columns=[{label:"Type",width:"5%"},{label:"Sequence Number",width:"20%"},{label:"Key",width:"40%"},{label:"Created Date",width:"20%"},{label:"Status",width:"10%"}];static \u0275fac=function(e){return new(e||n)};static \u0275cmp=f({type:n,selectors:[["app-serial-number-table"]],inputs:{models:"models"},standalone:!1,decls:6,vars:2,consts:[[1,"tsway-datatable","striped"],[3,"width",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"width"],[3,"innerHTML"]],template:function(e,r){e&1&&(o(0,"table",0)(1,"thead")(2,"tr"),T(3,Ge,2,2,"th",1),i()(),o(4,"tbody"),T(5,Ue,12,11,"tr",2),i()()),e&2&&(m(3),l("ngForOf",r.columns),m(2),l("ngForOf",r.models))},dependencies:[me,_e,K,A],encapsulation:2})};var j=class n{constructor(t){this.fb=t;let e=new y().date();this.filterForm=this.fb.group({type:[null],dateFrom:[e,d.required],dateTo:[e,d.required],status:[void 0],sequenceStart:[],sequenceEnd:[]}),this.dateFrom=this.filterForm.get("dateFrom"),this.dateTo=this.filterForm.get("dateTo")}filterChange=new N;filterForm;eSerialType=v;eStatusType=E;dateFrom;dateTo;onSubmit(){this.filterChange.emit({type:this.filterForm.get("type").value,dateTo:this.dateFrom.value?new y(this.dateFrom.value):void 0,dateFrom:this.dateTo.value?new y(this.dateTo.value):void 0,status:this.filterForm.get("status").value,sequenceStart:this.filterForm.get("sequenceStart").value,sequenceEnd:this.filterForm.get("sequenceEnd").value})}ngOnDestroy(){}static \u0275fac=function(e){return new(e||n)(c(P))};static \u0275cmp=f({type:n,selectors:[["app-serial-key-filterbar"]],outputs:{filterChange:"filterChange"},standalone:!1,decls:46,vars:10,consts:[[1,"filterbar","mb-3"],[1,"row","g-3","align-items-end",3,"formGroup"],[1,"col-md"],["for","type",1,"form-label","small","mb-1"],["id","type","formControlName","type",1,"form-control"],[3,"ngValue"],["for","sequenceStart",1,"form-label","small","mb-1"],["type","number","id","sequenceStart","formControlName","sequenceStart",1,"form-control"],["for","sequenceEnd",1,"form-label","small","mb-1"],["type","number","id","sequenceEnd","formControlName","sequenceEnd",1,"form-control"],["for","dateFrom",1,"form-label","small","mb-1"],["type","date","id","dateFrom","formControlName","dateFrom",1,"form-control"],["for","dateTo",1,"form-label","small","mb-1"],["type","date","id","dateTo","formControlName","dateTo",1,"form-control"],["for","status",1,"form-label","small","mb-1"],["id","status","formControlName","status",1,"form-control"],[1,"col-auto"],[1,"btn","btn-primary","w-100","d-flex","align-items-center","justify-content-center","gap-2",3,"click","disabled"],[1,"bi","bi-search"]],template:function(e,r){e&1&&(o(0,"div",0)(1,"form",1)(2,"div",2)(3,"label",3),a(4,"Type"),i(),o(5,"select",4)(6,"option",5),a(7,"All"),i(),o(8,"option",5),a(9,"Card"),i(),o(10,"option",5),a(11,"Token"),i()()(),o(12,"div",2)(13,"label",6),a(14,"Sequence Start"),i(),p(15,"input",7),i(),o(16,"div",2)(17,"label",8),a(18,"Sequence End"),i(),p(19,"input",9),i(),o(20,"div",2)(21,"label",10),a(22,"From*"),i(),p(23,"input",11),i(),o(24,"div",2)(25,"label",12),a(26,"To*"),i(),p(27,"input",13),i(),o(28,"div",2)(29,"label",14),a(30,"Status"),i(),o(31,"select",15)(32,"option",5),a(33,"All"),i(),o(34,"option",5),a(35,"Created"),i(),o(36,"option",5),a(37,"Delivered"),i(),o(38,"option",5),a(39,"Assigned"),i(),o(40,"option",5),a(41,"Inactive"),i()()(),o(42,"div",16)(43,"button",17),b("click",function(){return r.onSubmit()}),p(44,"i",18),a(45," Search "),i()()()()),e&2&&(m(),l("formGroup",r.filterForm),m(5),l("ngValue",null),m(2),l("ngValue",r.eSerialType.Card),m(2),l("ngValue",r.eSerialType.Token),m(22),l("ngValue",null),m(2),l("ngValue",r.eStatusType.Created),m(2),l("ngValue",r.eStatusType.Delivered),m(2),l("ngValue",r.eStatusType.Assigned),m(2),l("ngValue",r.eStatusType.Inactive),m(3),l("disabled",r.filterForm.invalid))},dependencies:[_,Ne,Te,ye,ve,he,ge,x,k,Ce],encapsulation:2})};function He(n,t){if(n&1&&(ee(0),p(1,"app-serial-number-table",6),te()),n&2){let e=ie();m(),l("models",e.models)}}function Qe(n,t){n&1&&(o(0,"div",7)(1,"div"),p(2,"i",8),o(3,"p",3),a(4,"Key records not found."),i()()())}var G=class n extends we{setting;constructor(t,e){super(e),this.modelService=t}getFilterParams(){let t=[],e=this.modelFilters;return e.type&&t.push({otpType:S(e.type)}),(e.status!==void 0||e.status!==null)&&t.push({status:S(e.status)}),e.dateFrom&&t.push({createdDate:R(e.dateFrom.date())}),e.dateTo&&t.push({createdDate:B(e.dateTo.date())}),e.sequenceStart&&t.push({sequenceNumber:R(e.sequenceStart)}),e.sequenceEnd&&t.push({sequenceNumber:B(e.sequenceEnd)}),t}ngOnInit(){}applyFilters(){this.loadModels().then()}openDialog(t){return I(this,null,function*(){(yield this.dialog.open(O,{model:t},{width:"22.5%"})).closed.subscribe(r=>{})})}static \u0275fac=function(e){return new(e||n)(c(h),c(X))};static \u0275cmp=f({type:n,selectors:[["app-serial-number"]],standalone:!1,features:[Z],decls:8,vars:2,consts:[["noData",""],[1,"container-fluid","py-4","d-flex","flex-column","vh-100"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"mb-0"],[3,"filterChange"],[4,"ngIf","ngIfElse"],[3,"models"],[1,"d-flex","justify-content-center","align-items-center","h-100","text-muted","text-center","px-4"],[1,"bi","bi-search","display-6","d-block","mb-2"]],template:function(e,r){if(e&1){let s=re();o(0,"div",1)(1,"div",2)(2,"h2",3),a(3,"OTP Keys"),i()(),o(4,"app-serial-key-filterbar",4),b("filterChange",function(Pe){return J(s),W(r.onFilterChange(Pe))}),i(),T(5,He,2,1,"ng-container",5)(6,Qe,5,0,"ng-template",null,0,ae),i()}if(e&2){let s=ne(7);m(5),l("ngIf",r.models.length>0)("ngIfElse",s)}},dependencies:[le,V,j],encapsulation:2})};var $e=[{path:"",component:G}],ke=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=Y({type:n});static \u0275inj=L({providers:[M,h],imports:[xe,se,pe.forChild($e),Fe,De]})};export{ke as SerialNumberModule};
